<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.9.1"/><meta data-react-helmet="true" name="description" content="GraphQL for .NET"/><meta data-react-helmet="true" name="keywords" content="graphql,api,web api,.net,.net core"/><style data-href="/styles.71340509c59b3fced1c9.css" data-identity="gatsby-global-css">.landing{margin:1.8rem auto}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;font-family:sans-serif}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{-webkit-text-decoration-skip:objects;background-color:transparent}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{box-sizing:border-box;font:112.5%/1.45em georgia,serif;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{word-wrap:break-word;-ms-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt";color:rgba(0,0,0,.8);font-family:georgia,serif;font-kerning:normal;font-weight:400}img{margin:0 0 1.45rem;max-width:100%;padding:0}h1{font-size:2.25rem}h1,h2{color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{list-style-image:none;list-style-position:outside;margin:0 0 1.45rem 1.45rem}ol{padding:0}dd,dl,figure,p{margin:0 0 1.45rem;padding:0}pre{word-wrap:normal;background:rgba(0,0,0,.04);border-radius:3px;font-size:.85rem;line-height:1.42;margin:0 0 1.45rem;overflow:auto;padding:1.45rem}table{border-collapse:collapse;font-size:1rem;line-height:1.45rem;width:100%}fieldset,table{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{background:rgba(0,0,0,.2);border:none;height:1px;margin:0 0 calc(1.45rem - 1px);padding:0}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-bottom:.725rem;margin-left:1.45rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";border-bottom:1px solid rgba(0,0,0,.12);padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{content:" ";letter-spacing:-.2em}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}code[class*=language-],pre[class*=language-]{word-wrap:normal;color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#073642}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{background:#eee8d5;color:#657b83}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}html{color:#2c3e50}body,html{-webkit-font-smoothing:antialiased;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-size:16px;overflow:auto;text-rendering:optimizeLegibility}body{margin:0}#___gatsby{overflow:auto}#gatsby-focus-wrapper{height:100%}ul{padding:0}li,ul{margin:0}a{color:#3eaf7c;text-decoration:underline}.header{border-bottom:1px solid #eaecef;height:60px}.header ul{padding:20px}.header li{display:inline-block;list-style:none;padding:0 12px}.header li a{color:#2c3e50;text-decoration:none}.footer{height:60px}.footer,.header{flex:none}.page-body{display:flex;flex-direction:column;height:calc(100% - 60px)}.content{height:100%;overflow-x:hidden;overflow-y:hidden;padding:2em;width:100%}.content ul{margin:20px 0}.content ul li{margin:0 0 0 30px}.content blockquote{border-left:7px solid #eaecef;margin:0 0 1.45rem;padding:30px}.content pre{margin-bottom:1.45rem}.content-body,.content-toolbar{margin:0 auto;max-width:740px}.content-toolbar{padding:1rem 0}.nav{border:0;flex-grow:1;min-width:18rem;order:1;overflow-x:hidden;overflow-y:inherit;padding-top:2rem}.nav li{list-style:none}.nav li span{display:block;font-weight:600;padding:.25rem 1rem .25rem 1.5rem}.nav ul{margin-bottom:15px}.nav ul a{border-left:.25rem solid transparent;color:#2c3e50;display:inline-block;line-height:1.4;padding:.25rem 1rem .25rem 1.25rem;text-decoration:none}.nav ul a:hover{color:#3eaf7c}.nav ul a.active{border-left:.25rem solid #3eaf7c;color:#3eaf7c;text-decoration:none}@media (min-width:768px){#___gatsby,body,html{height:100%;overflow-y:hidden}.page-body{flex-direction:row}.content{overflow-y:auto}.ads,.nav{order:-1}.nav{border-right:1px solid #eaecef;overflow-y:auto}}</style><title data-react-helmet="true">GraphQL .NET</title><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><nav class="header"><ul><li><a href="/">GraphQL.NET</a></li><li><a href="/docs/getting-started/introduction/">Docs</a></li><li><a href="https://github.com/graphql-dotnet/graphql-dotnet" rel="noopener noreferrer" target="_blank">GitHub</a></li></ul></nav><div class="page-body"><div class="content"><article class="content-body"><h1 id="json-serialization-and-deserialization" style="position:relative;"><a href="#json-serialization-and-deserialization" aria-label="json serialization and deserialization permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JSON Serialization and Deserialization</h1>
<p>Two libraries are available for assistance deserializing JSON-formatted GraphQL requests,
and serializing GraphQL responses in a JSON format. It is not mandatory to use JSON for the
request or response format, but it is common to do so. The two libraries are:</p>
<ul>
<li><a href="https://www.nuget.org/packages/GraphQL.SystemTextJson">GraphQL.SystemTextJson</a>, for use with the <code class="language-text">System.Text.Json</code> library, and</li>
<li><a href="https://www.nuget.org/packages/GraphQL.NewtonsoftJson">GraphQL.NewtonsoftJson</a>, for use with the <code class="language-text">Newtonsoft.Json</code> library</li>
</ul>
<p>These two projects have very similar classes and extension methods available. There are two notable
differences between the two serialization engines. First, the <code class="language-text">Newtonsoft.Json</code> library does not provide asynchronous
serialization or deserialization methods. Due to this reason, the async <code class="language-text">GraphQL.NewtonsoftJson</code> serialization
helper actually performs synchronous calls on the underlying stream when writing the JSON output. This is
significant when hosting the service via ASP.NET Core, as it is required to deliberately allow synchronous
reading and writing of the underlying stream. A sample of the required configuration is below:</p>
<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token class-name">IServiceCollection</span> services<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// If using Kestrel:</span>
    services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Configure</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>KestrelServerOptions<span class="token punctuation">></span></span></span><span class="token punctuation">(</span>options <span class="token operator">=></span>
    <span class="token punctuation">{</span>
        options<span class="token punctuation">.</span>AllowSynchronousIO <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// If using IIS:</span>
    services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Configure</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IISServerOptions<span class="token punctuation">></span></span></span><span class="token punctuation">(</span>options <span class="token operator">=></span>
    <span class="token punctuation">{</span>
        options<span class="token punctuation">.</span>AllowSynchronousIO <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>The above configuration options are not necessary with the <code class="language-text">System.Text.Json</code> serialization engine.</p>
<p>Second, the <code class="language-text">Newtonsoft.Json</code> library defaults to case-insensitive matching for key names when
deserializing objects. <code class="language-text">System.Text.Json</code> defaults to case-sensitive matching, but converts property
names to camel-case first. Take this example:</p>
<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Request</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Query <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> OperationName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">Inputs</span> Variables <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Deserializing the following JSON object is successful with either library:</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"query"</span><span class="token operator">:</span> <span class="token string">"query ($arg: Int!) { field1(arg: $arg) { childField } }"</span><span class="token punctuation">,</span>
    <span class="token property">"variables"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"arg"</span><span class="token operator">:</span> <span class="token number">55</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>However, the following JSON object fails with <code class="language-text">System.Text.Json</code>:</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"Query"</span><span class="token operator">:</span> <span class="token string">"query ($arg: Int!) { field1(arg: $arg) { childField } }"</span><span class="token punctuation">,</span>
    <span class="token property">"Variables"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"arg"</span><span class="token operator">:</span> <span class="token number">55</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>You can also configure the serialization and deserialization process for your needs
with either library, such as using case insensitive matching with <code class="language-text">System.Text.Json</code>
or enabling or disabling indenting on the serialized output. There are a number of
other differences as well.
<a href="https://docs.microsoft.com/en-us/dotnet/standard/serialization/system-text-json-migrate-from-newtonsoft-how-to?pivots=dotnet-5-0#table-of-differences-between-newtonsoftjson-and-systemtextjson">Click this link</a>
for a comprehensive table of differences between the two serialization engines.</p>
<p>The remainder of the documentation here will assume the use of the <code class="language-text">GraphQL.SystemTextJson</code>
library; slight changes may be necessary if you are using the <code class="language-text">GraphQL.NewtonsoftJson</code> library.</p>
<h1 id="deserialization-of-a-graphql-request-and-variables" style="position:relative;"><a href="#deserialization-of-a-graphql-request-and-variables" aria-label="deserialization of a graphql request and variables permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deserialization of a GraphQL request and variables</h1>
<p>The GraphQL.NET <code class="language-text">DocumentExecuter</code> requires the query and optional operation name as strings,
and the variables (if supplied) deserialized into an <code class="language-text">Inputs</code> object, which is a dictionary of
objects. This dictionary must be deserialized such that the objects it contains are lists (in the form
of <code class="language-text">IEnumerable</code> collections), objects (in the form of <code class="language-text">IDictionary&lt;string, object></code> collections),
or raw values (e.g. <code class="language-text">int</code>, <code class="language-text">long</code>, <code class="language-text">string</code>, <code class="language-text">Guid</code>, etc). Custom scalars may allow other types as well.</p>
<p>The <code class="language-text">InputsConverter</code> facilitates deserialization of JSON strings into this <code class="language-text">Inputs</code> object as described
above. For the <code class="language-text">Newtonsoft.Json</code> library, it is suggested to disable the automatic conversion of dates
so that the GraphQL.NET scalars can perform this task, enabling proper <code class="language-text">DateTimeOffset</code> deserialization.</p>
<p>You can also use one of the following extension methods to deserialize data with the required options set.</p>
<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">Inputs</span> <span class="token function">ToInputs</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name"><span class="token keyword">string</span></span> json<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">Inputs</span> <span class="token function">ToInputs</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">JsonElement</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">T</span> <span class="token generic-method"><span class="token function">FromJson</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name"><span class="token keyword">string</span></span> json<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// GraphQL.SystemTextJson only:</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">ValueTask<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> <span class="token generic-method"><span class="token function">FromJsonAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>Stream</span> stream<span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancellationToken <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// GraphQL.NewtonsoftJson only:</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">T</span> <span class="token generic-method"><span class="token function">FromJson</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>Stream</span> stream<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Here are a couple typical examples:</p>
<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token comment">// ASP.NET Core action with multipart/form-data or application/x-www-form-urlencoded encoding</span>
<span class="token punctuation">[</span><span class="token function">HttpPost</span><span class="token punctuation">(</span><span class="token string">"graphql"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name">IActionResult</span> <span class="token function">GraphQL</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> query<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> operationName<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> variables<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> inputs <span class="token operator">=</span> variables<span class="token punctuation">?.</span><span class="token function">ToInputs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// execute request and return result</span>
<span class="token punctuation">}</span>

<span class="token comment">// ASP.NET Core action with json encoding</span>
<span class="token punctuation">[</span><span class="token function">HttpPost</span><span class="token punctuation">(</span><span class="token string">"graphql"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name">IActionResult</span> <span class="token function">GraphQL</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">FromBody</span></span><span class="token punctuation">]</span> <span class="token class-name">Request</span> request<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// execute request and return result</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Request</span>
<span class="token punctuation">{</span>
    <span class="token return-type class-name"><span class="token keyword">string</span></span> Query <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token return-type class-name"><span class="token keyword">string</span></span> OperationName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token return-type class-name">JsonElement</span> Variables <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Other, with the request as a JSON string</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Execute</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> request<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> request <span class="token operator">=</span> requestString<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">FromJson</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Request<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// execute request and return result</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Request</span>
<span class="token punctuation">{</span>
    <span class="token return-type class-name"><span class="token keyword">string</span></span> Query <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token return-type class-name"><span class="token keyword">string</span></span> OperationName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token return-type class-name">Inputs</span> Variables <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h1 id="serialization-of-a-graphql-response" style="position:relative;"><a href="#serialization-of-a-graphql-response" aria-label="serialization of a graphql response permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Serialization of a GraphQL response</h1>
<p>Serialization of a <code class="language-text">ExecutionResult</code> object is handled by <code class="language-text">ExecutionResultJsonConverter</code> which accepts in its
constructor an instance of <code class="language-text">IErrorInfoProvider</code> (see <a href="#error-serialization">Error Serialization</a> below).
The converter can be registered within an instance of <code class="language-text">JsonSerializerOptions</code> so that serializing an
<code class="language-text">ExecutionResult</code> produces the proper output.</p>
<p>To assist, a <code class="language-text">DocumentWriter</code> class is provided with a single method, <code class="language-text">WriteAsync</code>, which
handles constructing the options, registering the converter, and serializing a specified
<code class="language-text">ExecutionResult</code> to a data stream. This class is designed to be registered as a singleton
within your dependency injection framework, if applicable.</p>
<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token comment">// Manually construct an instance</span>
<span class="token class-name"><span class="token keyword">var</span></span> documentWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DocumentWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Or register it within your DI framework (Microsoft DI sample below)</span>
services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddSingleton</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDocumentWriter<span class="token punctuation">,</span> DocumentWriter<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Here is an example of the <code class="language-text">DocumentWriter</code>'s use within the <code class="language-text">Harness</code> sample project:</p>
<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">WriteResponseAsync</span><span class="token punctuation">(</span><span class="token class-name">HttpContext</span> context<span class="token punctuation">,</span> <span class="token class-name">ExecutionResult</span> result<span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancellationToken<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    context<span class="token punctuation">.</span>Response<span class="token punctuation">.</span>ContentType <span class="token operator">=</span> <span class="token string">"application/json"</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span>Response<span class="token punctuation">.</span>StatusCode <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>

    <span class="token keyword">await</span> _documentWriter<span class="token punctuation">.</span><span class="token function">WriteAsync</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>Response<span class="token punctuation">.</span>Body<span class="token punctuation">,</span> result<span class="token punctuation">,</span> cancellationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>You can also write the result to a string with the <code class="language-text">WriteToStringAsync</code> extension method:</p>
<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token class-name"><span class="token keyword">var</span></span> resultText <span class="token operator">=</span> <span class="token keyword">await</span> _documentWriter<span class="token punctuation">.</span><span class="token function">WriteToStringAsync</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h2 id="error-serialization" style="position:relative;"><a href="#error-serialization" aria-label="error serialization permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Error Serialization</h2>
<p>The GraphQL spec allows for four properties to be returned within each
error: <code class="language-text">message</code>, <code class="language-text">locations</code>, <code class="language-text">path</code>, and <code class="language-text">extensions</code>. The <code class="language-text">IDocumentWriter</code> implementations
provided for the <a href="https://www.nuget.org/packages/GraphQL.NewtonsoftJson"><code class="language-text">Newtonsoft.Json</code></a> and
<a href="https://www.nuget.org/packages/GraphQL.SystemTextJson"><code class="language-text">System.Text.Json</code></a> packages allow you to control the
serialization of <code class="language-text">ExecutionError</code>s into the resulting json data by providing an <code class="language-text">IErrorInfoProvider</code>
to the constructor of the document writer. The <code class="language-text">ErrorInfoProvider</code> class (default implementation of
<code class="language-text">IErrorInfoProvider</code>) contains 5 properties to control serialization behavior:</p>
<ul>
<li><code class="language-text">ExposeExceptionStackTrace</code> when enabled sets the <code class="language-text">message</code> property for errors to equal the</li>
</ul>
<p>exception's <code class="language-text">.ToString()</code> method, which includes a stack trace. This property defaults to <code class="language-text">false</code>.</p>
<ul>
<li><code class="language-text">ExposeCode</code> when enabled sets the <code class="language-text">extensions</code>'s <code class="language-text">code</code> property to equal the error's <code class="language-text">Code</code></li>
</ul>
<p>property. This property defaults to <code class="language-text">true</code>.</p>
<ul>
<li><code class="language-text">ExposeCodes</code> when enabled sets the <code class="language-text">extensions</code>'s <code class="language-text">codes</code> property to equal a list containing both</li>
</ul>
<p>the error's <code class="language-text">Code</code> property, if any, and the type name of inner exceptions (after being converted to
UPPER_CASE and removing the "Extension" suffix). So an <code class="language-text">ExecutionError</code> with a code of <code class="language-text">INVALID_FORMAT</code>
that has an inner exception of type <code class="language-text">ArgumentNullException</code> would contain a <code class="language-text">codes</code> property
of <code class="language-text">["INVALID_FORMAT", "ARGUMENT_NULL"]</code>. This property defaults to <code class="language-text">true</code>.</p>
<ul>
<li><code class="language-text">ExposeData</code> when enabled sets the <code class="language-text">extension</code>'s <code class="language-text">data</code> property to equal the data within the error's</li>
</ul>
<p><code class="language-text">Data</code> property. This property defaults to <code class="language-text">true</code>.</p>
<ul>
<li><code class="language-text">ExposeExtensions</code> when disabled hides the entire <code class="language-text">extensions</code> property, including <code class="language-text">code</code>, <code class="language-text">codes</code>,</li>
</ul>
<p>and <code class="language-text">data</code> (if enabled). This property defaults to <code class="language-text">true</code>.</p>
<p>For example, to show the stack traces for unhandled errors during development, you might write code like this:</p>
<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token preprocessor property">#<span class="token directive keyword">if</span> DEBUG</span>
    <span class="token class-name"><span class="token keyword">var</span></span> documentWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DocumentWriter</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ErrorInfoProvider</span><span class="token punctuation">(</span>options <span class="token operator">=></span> options<span class="token punctuation">.</span>ExposeExceptionStackTrace <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
    <span class="token class-name"><span class="token keyword">var</span></span> documentWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DocumentWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span></code></pre></div>
<p>You can also write your own implementation of <code class="language-text">IErrorInfoProvider</code>. For instance, you might want to override
the numerical codes provided by GraphQL.NET for validation errors, reveal stack traces
only to logged-in administrators, or simply add information to the returned error object. Below is a sample
of a custom <code class="language-text">IErrorInfoProvider</code> that adds a date stamp to returned error objects:</p>
<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyErrorInfoProvider</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">GraphQL<span class="token punctuation">.</span>Execution<span class="token punctuation">.</span>ErrorInfoProvider</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name">ErrorInfo</span> <span class="token function">GetInfo</span><span class="token punctuation">(</span><span class="token class-name">ExecutionError</span> executionError<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> info <span class="token operator">=</span> <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">GetInfo</span><span class="token punctuation">(</span>executionError<span class="token punctuation">)</span><span class="token punctuation">;</span>
        info<span class="token punctuation">.</span>Extensions<span class="token punctuation">[</span><span class="token string">"timestamp"</span><span class="token punctuation">]</span> <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">"u"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> info<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div></article><div class="content-toolbar"><a href="https://github.com/graphql-dotnet/graphql-dotnet/edit/master/docs2/site/docs/guides/serialization.md" rel="noopener noreferrer" target="_blank">Edit this page on GitHub</a></div></div><div class="nav"><nav><ul><li><span>Getting Started</span><nav><ul><li><a class="" href="/docs/getting-started/introduction/">Introduction</a></li><li><a class="" href="/docs/getting-started/installation/">Installation</a></li><li><a class="" href="/docs/getting-started/graphiql/">GraphiQL</a></li><li><a class="" href="/docs/getting-started/altair-graphql/">Altair GraphQL</a></li><li><a class="" href="/docs/getting-started/queries/">Queries</a></li><li><a class="" href="/docs/getting-started/schema-types/">Schema Types</a></li><li><a class="" href="/docs/getting-started/custom-scalars/">Custom Scalars</a></li><li><a class="" href="/docs/getting-started/lists-non-null/">Lists and Non-Null</a></li><li><a class="" href="/docs/getting-started/arguments/">Arguments</a></li><li><a class="" href="/docs/getting-started/aliases/">Aliases</a></li><li><a class="" href="/docs/getting-started/fragments/">Fragments</a></li><li><a class="" href="/docs/getting-started/variables/">Variables</a></li><li><a class="" href="/docs/getting-started/directives/">Directives</a></li><li><a class="" href="/docs/getting-started/mutations/">Mutations</a></li><li><a class="" href="/docs/getting-started/interfaces/">Interfaces</a></li><li><a class="" href="/docs/getting-started/unions/">Unions</a></li><li><a class="" href="/docs/getting-started/subscriptions/">Subscriptions</a></li><li><a class="" href="/docs/getting-started/query-validation/">Query Validation</a></li><li><a class="" href="/docs/getting-started/query-organization/">Query Organization</a></li><li><a class="" href="/docs/getting-started/user-context/">User Context</a></li><li><a class="" href="/docs/getting-started/errors/">Error Handling</a></li><li><a class="" href="/docs/getting-started/dependency-injection/">Dependency Injection</a></li><li><a class="" href="/docs/getting-started/databases/">Databases</a></li><li><a class="" href="/docs/getting-started/malicious-queries/">Malicious Queries</a></li><li><a class="" href="/docs/getting-started/metadata/">Object/Field Metadata</a></li><li><a class="" href="/docs/getting-started/field-middleware/">Field Middleware</a></li><li><a class="" href="/docs/getting-started/metrics/">Metrics</a></li><li><a class="" href="/docs/getting-started/authorization/">Authorization</a></li><li><a class="" href="/docs/getting-started/relay/">Relay</a></li><li><a class="" href="/docs/getting-started/global-switches/">Global Switches</a></li></ul></nav></li><li><span>Guides</span><nav><ul><li><a aria-current="page" class="active" href="/docs/guides/serialization/">Serialization</a></li><li><a class="" href="/docs/guides/dataloader/">Dataloader</a></li><li><a class="" href="/docs/guides/schema-generation/">Schema Generation</a></li><li><a class="" href="/docs/guides/known-issues/">Known Issues &amp; FAQ</a></li><li><a class="" href="/docs/guides/links/">Links</a></li><li><a class="" href="/docs/guides/document-caching/">Document Caching</a></li></ul></nav></li><li><span>Analyzers</span><nav><ul><li><a class="" href="/docs/analyzers/Overview/">Overview</a></li><li><a class="" href="/docs/analyzers/GQL001_DefineTheNameInFieldMethod/">GQL001</a></li><li><a class="" href="/docs/analyzers/GQL002_NameMethodInvocationCanBeRemoved/">GQL002</a></li><li><a class="" href="/docs/analyzers/GQL003_DifferentNamesDefinedByFieldAndNameMethods/">GQL003</a></li><li><a class="" href="/docs/analyzers/GQL004_DoNotUseObsoleteFieldMethods/">GQL004</a></li><li><a class="" href="/docs/analyzers/GQL005_IllegalResolverUsage/">GQL005</a></li><li><a class="" href="/docs/analyzers/GQL006_CanNotMatchInputFieldToTheSourceField/">GQL006</a></li><li><a class="" href="/docs/analyzers/GQL007_CanNotSetSourceField/">GQL007</a></li><li><a class="" href="/docs/analyzers/GQL008_DoNotUseObsoleteArgumentMethod/">GQL008</a></li><li><a class="" href="/docs/analyzers/GQL009_UseAsyncResolver/">GQL009</a></li><li><a class="" href="/docs/analyzers/GQL011_MustNotBeConvertibleToGraphType/">GQL011</a></li></ul></nav></li><li><span>Migration Guides</span><nav><ul><li><a class="" href="/docs/migrations/migration7/">Migration Guide [v5 -&gt; v7]</a></li><li><a class="" href="/docs/migrations/migration5/">Migration Guide [v4 -&gt; v5]</a></li><li><a class="" href="/docs/migrations/migration4/">Migration Guide [v3 -&gt; v4]</a></li><li><a class="" href="/docs/migrations/migration3/">Migration Guide [v2 -&gt; v3]</a></li><li><a class="" href="/docs/migrations/migration2/">Migration Guide [v0.17.x -&gt; v2]</a></li><li><a class="" href="/docs/migrations/v0_11_0/">Migration Guide [v0.11.0]</a></li><li><a class="" href="/docs/migrations/v0_8_0/">Migration Guide [v0.8.0]</a></li></ul></nav></li></ul></nav></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/docs/guides/serialization/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-436da0dacbc7d0c9c70c.js\"],\"component---site-pages-landing-js\":[\"/component---site-pages-landing-js-a6440981f4cabd99c44a.js\"],\"component---src-components-docs-page-js\":[\"/component---src-components-docs-page-js-eb3cf7402e33f3b8c598.js\"],\"component---src-pages-404-js\":[\"/component---src-pages-404-js-124a3edb7b6bf3b7b21f.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="aa7a2afce7502c334a0a";</script><script src="/webpack-runtime-bc7601c4417363e3cebe.js" async></script><script src="/framework-5fba739d9f48dd9733f3.js" async></script><script src="/app-436da0dacbc7d0c9c70c.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>