<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/component---src-layouts-index-js-e8e2ac6da0b3fd0e25d9.js" as="script"/><link rel="preload" href="/component---src-templates-docs-page-js-8e21cb098d5f49b9ad94.js" as="script"/><link rel="preload" href="/path---docs-guides-dataloader-e71508790d18d3d143bb.js" as="script"/><link rel="preload" href="/app-25b650787e17e3ebc069.js" as="script"/><link rel="preload" href="/commons-a7cf6837d3c24c1c9d2a.js" as="script"/><title data-react-helmet="true">GraphQL .NET</title><meta data-react-helmet="true" name="description" content="GraphQL for .NET"/><meta data-react-helmet="true" name="keywords" content="graphql,api,web api,.net,.net core"/><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><style id="gatsby-inlined-css">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em georgia,serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:georgia,serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt","kern"}img{max-width:100%;margin:0 0 1.45rem;padding:0}h1{font-size:2.25rem}h1,h2{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{margin:0 0 1.45rem 1.45rem;padding:0;list-style-position:outside;list-style-image:none}dd,dl,figure,p{margin:0 0 1.45rem;padding:0}pre{padding:0;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}pre,table{margin:0 0 1.45rem}table{padding:0;font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{margin:0 0 calc(1.45rem - 1px);padding:0;background:rgba(0,0,0,.2);border:none;height:1px}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:0;padding-top:.2em;padding-bottom:.2em}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{background:#073642}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}html{color:#2c3e50}body,html{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;font-size:16px;overflow:auto}body{margin:0}#___gatsby{overflow:auto}ul{padding:0}li,ul{margin:0}a{color:#3eaf7c;text-decoration:underline}.header{height:60px;border-bottom:1px solid #eaecef}.header ul{padding:20px}.header li{list-style:none;display:inline-block;padding:0 12px}.header li a{color:#2c3e50;text-decoration:none}.footer{height:60px}.footer,.header{-ms-flex:none;flex:none}.page-body{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;height:calc(100% - 60px)}.content{height:100%;width:100%;overflow-y:hidden;overflow-x:hidden;padding:2em}.content ul{margin:20px 0}.content ul li{margin:0 0 0 30px}.content blockquote{padding:30px;border-left:7px solid #eaecef;margin:0 0 1.45rem}.content pre{margin-bottom:1.45rem}.content-body,.content-toolbar{margin:0 auto;max-width:740px}.content-toolbar{padding:1rem 0}.nav{padding-top:2rem;-ms-flex-order:1;order:1;overflow-y:inherit;overflow-x:hidden;-ms-flex-positive:1;flex-grow:1;border:0;min-width:18rem}.nav li{list-style:none}.nav li span{padding:.25rem 1rem .25rem 1.5rem;font-weight:600;display:block}.nav ul{margin-bottom:15px}.nav ul a{color:#2c3e50;padding:.25rem 1rem .25rem 1.25rem;border-left:.25rem solid transparent;display:inline-block;text-decoration:none;line-height:1.4}.nav ul a:hover{color:#3eaf7c}.nav ul a.active{color:#3eaf7c;border-left:.25rem solid #3eaf7c;text-decoration:none}@media (min-width:768px){#___gatsby,body,html{height:100%;overflow-y:hidden}.page-body{-ms-flex-direction:row;flex-direction:row}.content{overflow-y:auto}.ads,.nav{-ms-flex-order:-1;order:-1}.nav{overflow-y:auto;border-right:1px solid #eaecef}}.landing{margin:1.8rem auto}</style></head><body><div id="___gatsby"><nav class="header"><ul><li><a href="/">GraphQL.NET</a></li><li><a href="/docs/getting-started/introduction">Docs</a></li><li><a href="https://github.com/graphql-dotnet/graphql-dotnet" rel="noopener noreferrer" target="_blank">GitHub</a></li></ul></nav><div class="page-body"><div class="content"><article class="content-body"><h1 id="dataloader"><a href="#dataloader" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DataLoader</h1>
<p>GraphQL.NET includes an implementation of Facebook's <a href="https://github.com/facebook/dataloader">DataLoader</a> within the
<a href="https://www.nuget.org/packages/GraphQL.DataLoader"><code class="language-text">GraphQL.DataLoader</code></a> NuGet package.</p>
<p>Consider a GraphQL query like this:</p>
<div class="gatsby-highlight" data-language="graphql">
      <pre class="language-graphql"><code class="language-graphql"><span class="token punctuation">{</span>
	<span class="token property-query">orders</span><span class="token punctuation">(</span><span class="token attr-name">date</span><span class="token punctuation">:</span> <span class="token string">"2017-01-01"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token property">orderId</span>
		<span class="token property">date</span>
		<span class="token object">user</span> <span class="token punctuation">{</span>
			<span class="token property">userId</span>
			<span class="token property">firstName</span>
			<span class="token property">lastName</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>When the query is executed, first a list of orders is fetched. Then for each order, the associated user must also be fetched. If each user is fetched one-by-one, this would get more inefficient as the number of orders (N) grows. This is known as the N+1 problem. If there are 50 orders (N = 50), 51 separate requests would be made to load this data.</p>
<p>A DataLoader helps in two ways:</p>
<ol>
<li>Similar operations are batched together. This can make fetching data over a network much more efficient.</li>
<li>Fetched values are cached so if they are requested again, the cached value is returned.</li>
</ol>
<p>In the example above, a using a DataLoader will allow us to batch together all of the requests for the users. So there would be 1 request to retrieve the list of orders and 1 request to load all users associated with those orders. This would always be a total of 2 requests rather than N+1.</p>
<h2 id="setup"><a href="#setup" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setup</h2>
<ol>
<li>Register <code class="language-text">IDataLoaderContextAccessor</code> in your IoC container.</li>
<li>Register <code class="language-text">DataLoaderDocumentListener</code> in your IoC container.</li>
</ol>
<div class="gatsby-highlight" data-language="csharp">
      <pre class="language-csharp"><code class="language-csharp">services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddSingleton</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDataLoaderContextAccessor<span class="token punctuation">,</span> DataLoaderContextAccessor<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddSingleton</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>DataLoaderDocumentListener<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div>
<ol start="3">
<li>Hook up your GraphQL schema to your IoC container.</li>
</ol>
<div class="gatsby-highlight" data-language="csharp">
      <pre class="language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MySchema</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Schema</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">MySchema</span><span class="token punctuation">(</span><span class="token class-name">IServiceProvider</span> services<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span>services<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<div class="gatsby-highlight" data-language="csharp">
      <pre class="language-csharp"><code class="language-csharp">services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddSingleton</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MySchema<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div>
<ol start="4">
<li>Add the <code class="language-text">DataLoaderDocumentListener</code> to the <code class="language-text">DocumentExecuter</code>.</li>
</ol>
<div class="gatsby-highlight" data-language="csharp">
      <pre class="language-csharp"><code class="language-csharp"><span class="token class-name"><span class="token keyword">var</span></span> listener <span class="token operator">=</span> Services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetRequiredService</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>DataLoaderDocumentListener<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> executer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DocumentExecuter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> executer<span class="token punctuation">.</span><span class="token function">ExecuteAsync</span><span class="token punctuation">(</span>opts <span class="token operator">=></span> <span class="token punctuation">{</span>

	<span class="token range operator">..</span><span class="token punctuation">.</span>

	opts<span class="token punctuation">.</span>Listeners<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div>
<h2 id="usage"><a href="#usage" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Usage</h2>
<p>First, inject the <code class="language-text">IDataLoaderContextAccessor</code> into your GraphQL type class.</p>
<p>Then use the <code class="language-text">Context</code> property on the accessor to get the current <code class="language-text">DataLoaderContext</code>. The <code class="language-text">DataLoaderDocumentListener</code> configured above ensures that each request will have its own context instance.</p>
<p>Use one of the "GetOrAddLoader" methods on the <code class="language-text">DataLoaderContext</code>. These methods all require a string key to uniquely identify each loader. They also require a delegate for fetching the data. Each method will get an existing loader or add a new one, identified by the string key. Each method has various overloads to support different ways to load and map data with the keys.</p>
<p>Call <code class="language-text">LoadAsync()</code> on the data loader. This will queue the request and return a <code class="language-text">IDataLoaderResult&lt;T></code>. If the result has already been cached, the returned value will be pulled from the cache.</p>
<p>The <code class="language-text">ExecutionStrategy</code> will dispatch queued data loaders after all other pending fields have been resolved.</p>
<p>If your code requires an asynchronous call prior to queuing the data loader, use the <code class="language-text">ResolveAsync</code> field builder method to return a
<code class="language-text">Task&lt;IDataLoaderResult&lt;T>></code>. The execution strategy will start executing the asynchronous code as soon as the field resolver executes.
Once the <code class="language-text">IDataLoaderResult&lt;T></code> is retrieved from the asynchronous task, the data loader will be queued to be dispatched once all
other pending fields have been resolved.</p>
<p>To execute code within the resolver after the data loader has retrieved the data, pass a delegate to the <code class="language-text">Then</code> extension
method of the returned <code class="language-text">IDataLoaderResult&lt;T></code>. You can use a synchronous or asynchronous delegate, and it can return another
<code class="language-text">IDataLoaderResult&lt;T></code> if you wish to chain dataloaders together. This may result in the field builder's Resolve delegate
signature looking like <code class="language-text">IDataLoaderResult&lt;IDataLoaderResult&lt;T>></code>, which is correct and will be handled properly by the execution strategy.</p>
<h2 id="examples"><a href="#examples" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Examples</h2>
<p>This is an example of using a DataLoader to batch requests for loading items by a key. <code class="language-text">LoadAsync()</code> is called by the field resolver for each Order. <code class="language-text">IUsersStore.GetUsersByIdAsync()</code> will be called with the batch of userIds that were requested.</p>
<div class="gatsby-highlight" data-language="csharp">
      <pre class="language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderType</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ObjectGraphType<span class="token punctuation">&lt;</span>Order<span class="token punctuation">></span></span></span>
<span class="token punctuation">{</span>
    <span class="token comment">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>
    <span class="token keyword">public</span> <span class="token function">OrderType</span><span class="token punctuation">(</span><span class="token class-name">IDataLoaderContextAccessor</span> accessor<span class="token punctuation">,</span> <span class="token class-name">IUsersStore</span> users<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token range operator">..</span><span class="token punctuation">.</span>

        <span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>UserType<span class="token punctuation">,</span> User<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token string">"User"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ResolveAsync</span><span class="token punctuation">(</span>context <span class="token operator">=></span>
            <span class="token punctuation">{</span>
                <span class="token comment">// Get or add a batch loader with the key "GetUsersById"</span>
                <span class="token comment">// The loader will call GetUsersByIdAsync for each batch of keys</span>
                <span class="token class-name"><span class="token keyword">var</span></span> loader <span class="token operator">=</span> accessor<span class="token punctuation">.</span>Context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetOrAddBatchLoader</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> User<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token string">"GetUsersById"</span><span class="token punctuation">,</span> users<span class="token punctuation">.</span>GetUsersByIdAsync<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Add this UserId to the pending keys to fetch</span>
                <span class="token comment">// The execution strategy will trigger the data loader to fetch the data via GetUsersByIdAsync() at the</span>
                <span class="token comment">//   appropriate time, and the field will be resolved with an instance of User once GetUsersByIdAsync()</span>
                <span class="token comment">//   returns with the batched results</span>
                <span class="token keyword">return</span> loader<span class="token punctuation">.</span><span class="token function">LoadAsync</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>Source<span class="token punctuation">.</span>UserId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IUsersStore</span>
<span class="token punctuation">{</span>
    <span class="token comment">// This will be called by the loader for all pending keys</span>
    <span class="token comment">// Note that fetch delegates can accept a CancellationToken parameter or not</span>
    <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>IDictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> User<span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">GetUsersByIdAsync</span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">></span></span> userIds<span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancellationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>This is an example of using a DataLoader to batch requests for loading a collection of items by a key. This is used when a key may be associated with more than one item. <code class="language-text">LoadAsync()</code> is called by the field resolver for each User. A User can have zero to many Orders. <code class="language-text">IOrdersStore.GetOrdersByUserIdAsync</code> will be called with a batch of userIds that have been requested.</p>
<div class="gatsby-highlight" data-language="csharp">
      <pre class="language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserType</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ObjectGraphType<span class="token punctuation">&lt;</span>User<span class="token punctuation">></span></span></span>
<span class="token punctuation">{</span>
    <span class="token comment">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>
    <span class="token keyword">public</span> <span class="token function">UserType</span><span class="token punctuation">(</span><span class="token class-name">IDataLoaderContextAccessor</span> accessor<span class="token punctuation">,</span> <span class="token class-name">IOrdersStore</span> orders<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token range operator">..</span><span class="token punctuation">.</span>

        <span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ListGraphType<span class="token punctuation">&lt;</span>OrderType<span class="token punctuation">></span><span class="token punctuation">,</span> IEnumerable<span class="token punctuation">&lt;</span>Order<span class="token punctuation">></span><span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token string">"Orders"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ResolveAsync</span><span class="token punctuation">(</span>ctx <span class="token operator">=></span>
            <span class="token punctuation">{</span>
                <span class="token comment">// Get or add a collection batch loader with the key "GetOrdersByUserId"</span>
                <span class="token comment">// The loader will call GetOrdersByUserIdAsync with a batch of keys</span>
                <span class="token class-name"><span class="token keyword">var</span></span> ordersLoader <span class="token operator">=</span> accessor<span class="token punctuation">.</span>Context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetOrAddCollectionBatchLoader</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token string">"GetOrdersByUserId"</span><span class="token punctuation">,</span>
                    orders<span class="token punctuation">.</span>GetOrdersByUserIdAsync<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Add this UserId to the pending keys to fetch data for</span>
                <span class="token comment">// The execution strategy will trigger the data loader to fetch the data via GetOrdersByUserId() at the</span>
                <span class="token comment">//   appropriate time, and the field will be resolved with an instance of IEnumerable&lt;Order> once</span>
                <span class="token comment">//   GetOrdersByUserId() returns with the batched results</span>
                <span class="token keyword">return</span> ordersLoader<span class="token punctuation">.</span><span class="token function">LoadAsync</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>Source<span class="token punctuation">.</span>UserId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrdersStore</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IOrdersStore</span></span>
<span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>ILookup<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">GetOrdersByUserIdAsync</span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">></span></span> userIds<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token class-name"><span class="token keyword">var</span></span> orders <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token comment">// load data from database</span>

		<span class="token keyword">return</span> orders
			<span class="token punctuation">.</span><span class="token function">ToLookup</span><span class="token punctuation">(</span>x <span class="token operator">=></span> x<span class="token punctuation">.</span>UserId<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>This is an example of using a DataLoader without batching. This could be useful if the data may be requested multiple times. The result will be cached the first time. Subsequent calls to <code class="language-text">LoadAsync()</code> will return the cached result.</p>
<div class="gatsby-highlight" data-language="csharp">
      <pre class="language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryType</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ObjectGraphType</span></span>
<span class="token punctuation">{</span>
    <span class="token comment">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>
    <span class="token keyword">public</span> <span class="token function">QueryType</span><span class="token punctuation">(</span><span class="token class-name">IDataLoaderContextAccessor</span> accessor<span class="token punctuation">,</span> <span class="token class-name">IUsersStore</span> users<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ListGraphType<span class="token punctuation">&lt;</span>UserType<span class="token punctuation">></span><span class="token punctuation">,</span> IEnumerable<span class="token punctuation">&lt;</span>User<span class="token punctuation">></span><span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token string">"Users"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">"Get all Users"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ResolveAsync</span><span class="token punctuation">(</span>ctx <span class="token operator">=></span>
            <span class="token punctuation">{</span>
                <span class="token comment">// Get or add a loader with the key "GetAllUsers"</span>
                <span class="token class-name"><span class="token keyword">var</span></span> loader <span class="token operator">=</span> accessor<span class="token punctuation">.</span>Context<span class="token punctuation">.</span><span class="token function">GetOrAddLoader</span><span class="token punctuation">(</span><span class="token string">"GetAllUsers"</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> users<span class="token punctuation">.</span><span class="token function">GetAllUsersAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Prepare the load operation</span>
                <span class="token comment">// If the result is cached, a completed Task&lt;IEnumerable&lt;User>> will be returned</span>
                <span class="token keyword">return</span> loader<span class="token punctuation">.</span><span class="token function">LoadAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IUsersStore</span>
<span class="token punctuation">{</span>
	<span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>IEnumerable<span class="token punctuation">&lt;</span>User<span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">GetAllUsersAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>This is an example of using two chained DataLoaders to batch requests together, with asynchronous code before the data loaders execute, and post-processing afterwards.</p>
<div class="gatsby-highlight" data-language="csharp">
      <pre class="language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserType</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ObjectGraphType<span class="token punctuation">&lt;</span>User<span class="token punctuation">></span></span></span>
<span class="token punctuation">{</span>
    <span class="token comment">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>
    <span class="token keyword">public</span> <span class="token function">UserType</span><span class="token punctuation">(</span><span class="token class-name">IDataLoaderContextAccessor</span> accessor<span class="token punctuation">,</span> <span class="token class-name">IUsersStore</span> users<span class="token punctuation">,</span> <span class="token class-name">IOrdersStore</span> orders<span class="token punctuation">,</span> <span class="token class-name">IItemsStore</span> items<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token range operator">..</span><span class="token punctuation">.</span>

        <span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ListGraphType<span class="token punctuation">&lt;</span>ItemType<span class="token punctuation">></span><span class="token punctuation">,</span> IEnumerable<span class="token punctuation">&lt;</span>Item<span class="token punctuation">></span><span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token string">"OrderedItems"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ResolveAsync</span><span class="token punctuation">(</span><span class="token keyword">async</span> context <span class="token operator">=></span>
            <span class="token punctuation">{</span>
                <span class="token comment">// Asynchronously authenticate</span>
                <span class="token class-name"><span class="token keyword">var</span></span> valid <span class="token operator">=</span> <span class="token keyword">await</span> users<span class="token punctuation">.</span><span class="token function">CanViewOrders</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>Source<span class="token punctuation">.</span>UserId<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>valid<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                
                <span class="token comment">// Get or add a collection batch loader with the key "GetOrdersByUserId"</span>
                <span class="token comment">// The loader will call GetOrdersByUserIdAsync with a batch of keys</span>
                <span class="token class-name"><span class="token keyword">var</span></span> ordersLoader <span class="token operator">=</span> accessor<span class="token punctuation">.</span>Context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetOrAddCollectionBatchLoader</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token string">"GetOrdersByUserId"</span><span class="token punctuation">,</span>
                    orders<span class="token punctuation">.</span>GetOrdersByUserIdAsync<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token class-name"><span class="token keyword">var</span></span> ordersResult <span class="token operator">=</span> ordersLoader<span class="token punctuation">.</span><span class="token function">LoadAsync</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>Source<span class="token punctuation">.</span>UserId<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Once the orders have been retrieved by the first data loader, feed the order IDs into</span>
                <span class="token comment">//   the second data loader</span>
                <span class="token keyword">return</span> ordersResult<span class="token punctuation">.</span><span class="token function">Then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>orders<span class="token punctuation">,</span> cancellationToken<span class="token punctuation">)</span> <span class="token operator">=></span>
                <span class="token punctuation">{</span>
                    <span class="token comment">// Collect all of the order IDs</span>
                    <span class="token class-name"><span class="token keyword">var</span></span> orderIds <span class="token operator">=</span> orders<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>o <span class="token operator">=></span> o<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Get or add a collection batch loader with the key "GetItemsByOrderId"</span>
                    <span class="token comment">// The loader will call GetItemsByOrderId with a batch of keys</span>
                    <span class="token class-name"><span class="token keyword">var</span></span> itemsLoader <span class="token operator">=</span> accessor<span class="token punctuation">.</span>Context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetOrAddCollectionBatchLoader</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Item<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token string">"GetItemsByOrderId"</span><span class="token punctuation">,</span>
                        items<span class="token punctuation">.</span>GetItemsByOrderIdAsync<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token class-name"><span class="token keyword">var</span></span> itemsResults <span class="token operator">=</span> itemsLoader<span class="token punctuation">.</span><span class="token function">LoadAsync</span><span class="token punctuation">(</span>orderIds<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// itemsResults is of type IDataLoaderResult&lt;IEnumerable&lt;Item>[]> so the array needs to be flattened</span>
                    <span class="token comment">//   before returning it back to the query</span>
                    <span class="token keyword">return</span> itemsResults<span class="token punctuation">.</span><span class="token function">Then</span><span class="token punctuation">(</span>itemResultSet <span class="token operator">=></span>
                    <span class="token punctuation">{</span>
                        <span class="token comment">// Flatten the results after the second dataloader has finished</span>
                        <span class="token keyword">return</span> flattenedResults <span class="token operator">=</span> itemResultSet<span class="token punctuation">.</span><span class="token function">SelectMany</span><span class="token punctuation">(</span>x <span class="token operator">=></span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IUsersStore</span>
<span class="token punctuation">{</span>
    <span class="token comment">// This will be called for each call to OrderedItems, prior to any data loader execution</span>
    <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">bool</span><span class="token punctuation">></span></span> <span class="token function">CanViewOrders</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IOrdersStore</span>
<span class="token punctuation">{</span>
    <span class="token comment">// This will be called by the "order" loader for all pending keys</span>
    <span class="token comment">// Note that fetch delegates can accept a CancellationToken parameter or not</span>
    <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>ILookup<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">GetOrdersByUserIdAsync</span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">></span></span> userIds<span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancellationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IItemsStore</span>
<span class="token punctuation">{</span>
    <span class="token comment">// This will be called by the "item" loader for all pending keys</span>
    <span class="token comment">// Note that fetch delegates can accept a CancellationToken parameter or not</span>
    <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>ILookup<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Item<span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">GetItemsByOrderIdAsync</span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">></span></span> orderIds<span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancellationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<blockquote>
<p>See this <a href="https://fiyazhasan.me/graphql-with-net-core-part-xi-dataloader/">blog series</a> for an in depth example using Entity Framework.</p>
</blockquote>
<h2 id="exceptions"><a href="#exceptions" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exceptions</h2>
<p>Exceptions within data loaders' fetch delegates are passed back to the execution strategy for all associated fields.
If you have a need to capture exceptions raised by the fetch delegate, create a <code class="language-text">new SimpleDataLoader&lt;T></code> within
your field resolver (do not use the <code class="language-text">IDataLoaderContextAccessor</code> for this) and have its fetch delegate await the
<code class="language-text">IDataLoaderResult&lt;T>.GetResultAsync</code> method of the result obtained from the first data loader within a try/catch
block. Return the result of the simple data loader's <code class="language-text">LoadAsync()</code> function to the field resolver.  The data loader
will still load at the appropriate time, and you can handle exceptions as desired.</p>
<h2 id="di-based-data-loaders"><a href="#di-based-data-loaders" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DI-based data loaders</h2>
<p>The above instructions describe how to use the data loader context and accessor classes to create data loaders scoped
to the current request. You can also use dependency injection to register a data loader instance. This can eliminate
duplicated code if you call the same data loader from different field resolvers. It can also help to prevent
unforseen bugs due to a data loader fetch delegate capturing variables from a field resolver's scope.</p>
<p>To create a custom and register a custom data loader instance, first create a class and inherit <code class="language-text">DataLoaderBase&lt;TKey, T></code>.
Override the <code class="language-text">FetchAsync</code> method with the code to retrieve the data based on the provided keys. Call <code class="language-text">SetResult</code> on
each provided <code class="language-text">DataLoaderPair</code> to set the result. Feel free to use dependency injection to rely on any scoped services
necessary to facilitate execution of the fetch method. See below sample:</p>
<div class="gatsby-highlight" data-language="csharp">
      <pre class="language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Order</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> ShipToName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderItem</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> OrderId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> ItemName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// similar to BatchDataLoader</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyOrderDataLoader</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">DataLoaderBase<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">MyDbContext</span> _dbContext<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">MyOrderDataLoader</span><span class="token punctuation">(</span><span class="token class-name">MyDbContext</span> dataContext<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _dbContext <span class="token operator">=</span> dataContext<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">FetchAsync</span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>DataLoaderPair<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span><span class="token punctuation">></span></span> list<span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancellationToken<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">></span></span> ids <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>pair <span class="token operator">=></span> pair<span class="token punctuation">.</span>Key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IDictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span></span> data <span class="token operator">=</span> <span class="token keyword">await</span> _dbContext<span class="token punctuation">.</span>Orders<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>order <span class="token operator">=></span> ids<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToDictionaryAsync</span><span class="token punctuation">(</span>x <span class="token operator">=></span> x<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> cancellationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">DataLoaderPair<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span></span> entry <span class="token keyword">in</span> list<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            entry<span class="token punctuation">.</span><span class="token function">SetResult</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>TryGetValue<span class="token class-name"><span class="token punctuation">(</span>entry<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token keyword">var</span> order<span class="token punctuation">)</span> <span class="token punctuation">?</span></span> order <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// similar to CollectionBatchDataLoader</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyOrderItemsDataLoader</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">DataLoaderBase<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> IEnumerable<span class="token punctuation">&lt;</span>OrderItem<span class="token punctuation">></span><span class="token punctuation">></span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">MyDbContext</span> _dbContext<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">MyOrderItemsDataLoader</span><span class="token punctuation">(</span><span class="token class-name">MyDbContext</span> dataContext<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _dbContext <span class="token operator">=</span> dataContext<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name">Task</span> <span class="token function">FetchAsync</span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>DataLoaderPair<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> IEnumerable<span class="token punctuation">&lt;</span>OrderItem<span class="token punctuation">></span><span class="token punctuation">></span><span class="token punctuation">></span></span> list<span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancellationToken<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">></span></span> ids <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>pair <span class="token operator">=></span> pair<span class="token punctuation">.</span>Key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>OrderItem<span class="token punctuation">></span></span> data <span class="token operator">=</span> <span class="token keyword">await</span> _dbContext<span class="token punctuation">.</span>OrderItems<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>orderItem <span class="token operator">=></span> ids<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>orderItem<span class="token punctuation">.</span>OrderId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToListAsync</span><span class="token punctuation">(</span>cancellationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ILookup<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> OrderItem<span class="token punctuation">></span></span> dataLookup <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">ToLookup</span><span class="token punctuation">(</span>x <span class="token operator">=></span> x<span class="token punctuation">.</span>OrderId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">DataLoaderPair<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> IEnumerable<span class="token punctuation">&lt;</span>OrderItem<span class="token punctuation">></span><span class="token punctuation">></span></span> entry <span class="token keyword">in</span> list<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            entry<span class="token punctuation">.</span><span class="token function">SetResult</span><span class="token punctuation">(</span>dataLookup<span class="token punctuation">[</span>entry<span class="token punctuation">.</span>Key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>You will need to register the data loader as a scoped service within your DI framework.</p>
<div class="gatsby-highlight" data-language="csharp">
      <pre class="language-csharp"><code class="language-csharp">services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddScoped</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MyOrderDataLoader<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddScoped</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MyOrderItemsDataLoader<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div>
<p>Then within your field resolvers, access the data loader via the <code class="language-text">RequestServices</code> property and call <code class="language-text">LoadAsync</code> as before:</p>
<div class="gatsby-highlight" data-language="csharp">
      <pre class="language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyQuery</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ObjectGraphType</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">MyQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>OrderType<span class="token punctuation">,</span> Order<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token string">"Order"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Argument</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IdGraphType<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ResolveAsync</span><span class="token punctuation">(</span>context <span class="token operator">=></span>
            <span class="token punctuation">{</span>
                <span class="token comment">// Get the custom data loader</span>
                <span class="token class-name"><span class="token keyword">var</span></span> loader <span class="token operator">=</span> context<span class="token punctuation">.</span>RequestServices<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetRequiredService</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MyOrderDataLoader<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Add this UserId to the pending keys to fetch.</span>
                <span class="token comment">// The execution strategy will trigger the data loader to fetch the data via MyOrderDataLoader.FetchAsync() at the</span>
                <span class="token comment">// appropriate time, and the field will be resolved with an instance of Order once FetchAsync()</span>
                <span class="token comment">// returns with the batched results</span>
                <span class="token keyword">return</span> loader<span class="token punctuation">.</span><span class="token function">LoadAsync</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetArgument</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderType</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ObjectGraphType<span class="token punctuation">&lt;</span>Order<span class="token punctuation">></span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">OrderType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">Field</span><span class="token punctuation">(</span>x <span class="token operator">=></span> x<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> <span class="token named-parameter punctuation">type</span><span class="token punctuation">:</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">IdGraphType</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Field</span><span class="token punctuation">(</span>x <span class="token operator">=></span> x<span class="token punctuation">.</span>ShipToName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ListGraphType<span class="token punctuation">&lt;</span>OrderItemType<span class="token punctuation">></span><span class="token punctuation">,</span> IEnumerable<span class="token punctuation">&lt;</span>OrderItem<span class="token punctuation">></span><span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token string">"Items"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ResolveAsync</span><span class="token punctuation">(</span>context <span class="token operator">=></span>
            <span class="token punctuation">{</span>
                <span class="token class-name"><span class="token keyword">var</span></span> loader <span class="token operator">=</span> context<span class="token punctuation">.</span>RequestServices<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetRequiredService</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MyOrderItemsDataLoader<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> loader<span class="token punctuation">.</span><span class="token function">LoadAsync</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>Source<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>You do not need to use <code class="language-text">IDataLoaderContextAccessor</code> or <code class="language-text">DataLoaderDocumentListener</code> and may remove those references
from your code.</p>
<h2 id="singleton-di-based-data-loader-instances"><a href="#singleton-di-based-data-loader-instances" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Singleton DI-based data loader instances</h2>
<p>If you wish to register the data loader as a singleton, be sure to disable caching by calling <code class="language-text">: base(false)</code> in
the constructor, as the cache entries never expire. You will also need to be sure your code does not rely on any
scoped services, or create a dedicated service scope within the fetch method as shown below.</p>
<div class="gatsby-highlight" data-language="csharp">
      <pre class="language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyOrderDataLoader</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">DataLoaderBase<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">IServiceProvider</span> _rootServiceProvider<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">MyOrderDataLoader</span><span class="token punctuation">(</span><span class="token class-name">IServiceProvider</span> serviceProvider<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _rootServiceProvider <span class="token operator">=</span> serviceProvider<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">FetchAsync</span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>DataLoaderPair<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span><span class="token punctuation">></span></span> list<span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancellationToken<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> scope <span class="token operator">=</span> _rootServiceProvider<span class="token punctuation">.</span><span class="token function">CreateScope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name">MyDbContext</span> dbContext <span class="token operator">=</span> scope<span class="token punctuation">.</span>ServiceProvider<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetRequiredService</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MyDbContext<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">></span></span> ids <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>pair <span class="token operator">=></span> pair<span class="token punctuation">.</span>Key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">IDictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span></span> data <span class="token operator">=</span> <span class="token keyword">await</span> dbContext<span class="token punctuation">.</span>Orders<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>order <span class="token operator">=></span> ids<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToDictionaryAsync</span><span class="token punctuation">(</span>x <span class="token operator">=></span> x<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> cancellationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">DataLoaderPair<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span></span> entry <span class="token keyword">in</span> list<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                entry<span class="token punctuation">.</span><span class="token function">SetResult</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>TryGetValue<span class="token class-name"><span class="token punctuation">(</span>entry<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token keyword">var</span> order<span class="token punctuation">)</span> <span class="token punctuation">?</span></span> order <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>As a singleton, you can pull the singleton instance into your graphtype class in its constructor.</p>
<div class="gatsby-highlight" data-language="csharp">
      <pre class="language-csharp"><code class="language-csharp">    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyQuery</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ObjectGraphType</span></span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token function">MyQuery</span><span class="token punctuation">(</span><span class="token class-name">MyOrderDataLoader</span> loader<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>OrderType<span class="token punctuation">,</span> Order<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token string">"Order"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Argument</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IdGraphType<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">ResolveAsync</span><span class="token punctuation">(</span>context <span class="token operator">=></span>
                <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> loader<span class="token punctuation">.</span><span class="token function">LoadAsync</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetArgument</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre>
      </div>
<h2 id="adding-a-global-cache"><a href="#adding-a-global-cache" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding a global cache</h2>
<p>Data loaders will, by default, cache values returned for a given key for the lifetime of a request. You can change
the fetch method of your data loader to use a global cache. The below sample demonstrates changes required to a singleton
DI-based data loader as shown immediately above, using the <code class="language-text">Microsoft.Extensions.Caching.Memory</code> NuGet package.</p>
<div class="gatsby-highlight" data-language="csharp">
      <pre class="language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyOrderDataLoader</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">DataLoaderBase<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">IServiceProvider</span> _rootServiceProvider<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">IMemoryCache</span> _memoryCache<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">MemoryCacheEntryOptions</span> _memoryCacheEntryOptions<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">string</span></span> CACHE_PREFIX <span class="token operator">=</span> <span class="token string">"ORDER_"</span><span class="token punctuation">;</span>
        
    <span class="token keyword">public</span> <span class="token function">MyOrderDataLoader</span><span class="token punctuation">(</span><span class="token class-name">IServiceProvider</span> serviceProvider<span class="token punctuation">,</span> <span class="token class-name">IMemoryCache</span> memoryCache<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _rootServiceProvider <span class="token operator">=</span> serviceProvider<span class="token punctuation">;</span>
        _memoryCache <span class="token operator">=</span> memoryCache<span class="token punctuation">;</span>
        _memoryCacheEntryOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MemoryCacheEntryOptions</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// specify a maximum lifetime of 5 minutes</span>
            AbsoluteExpirationRelativeToNow <span class="token operator">=</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromMinutes</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment">// set so that the size of the cache can be limited</span>
            Size <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">FetchAsync</span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>DataLoaderPair<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span><span class="token punctuation">></span></span> list<span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancellationToken<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// create a list of keys that are not in the cache</span>
        <span class="token class-name"><span class="token keyword">var</span></span> unMatched <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>DataLoaderPair<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span><span class="token punctuation">></span></span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// attempt to match any keys possible from the global cache</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> entry <span class="token keyword">in</span> list<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>_memoryCache<span class="token punctuation">.</span><span class="token function">TryGetValue</span><span class="token punctuation">(</span>CACHE_PREFIX <span class="token operator">+</span> entry<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">var</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                entry<span class="token punctuation">.</span><span class="token function">SetResult</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Order<span class="token punctuation">)</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{</span>
                unMatched<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// process the unmatched keys as usual</span>
        list <span class="token operator">=</span> unMatched<span class="token punctuation">;</span>
        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> scope <span class="token operator">=</span> _rootServiceProvider<span class="token punctuation">.</span><span class="token function">CreateScope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> dbContext <span class="token operator">=</span> scope<span class="token punctuation">.</span>ServiceProvider<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetRequiredService</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MyDbContext<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">></span></span> ids <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>pair <span class="token operator">=></span> pair<span class="token punctuation">.</span>Key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">IDictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span></span> data <span class="token operator">=</span> <span class="token keyword">await</span> dbContext<span class="token punctuation">.</span>Orders<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>order <span class="token operator">=></span> ids<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToDictionaryAsync</span><span class="token punctuation">(</span>x <span class="token operator">=></span> x<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> cancellationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">DataLoaderPair<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Order<span class="token punctuation">></span></span> entry <span class="token keyword">in</span> list<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">TryGetValue</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">var</span></span> order<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token comment">// only save the entry in the cache if it was found in the database</span>
                    _memoryCache<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span>CACHE_PREFIX <span class="token operator">+</span> entry<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> order<span class="token punctuation">,</span> _memoryCacheEntryOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    entry<span class="token punctuation">.</span><span class="token function">SetResult</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{</span>
                    entry<span class="token punctuation">.</span><span class="token function">SetResult</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// also, register the memory cache in your DI configuration</span>
<span class="token comment">// limit cache to 10,000 entries</span>
services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddSingleton</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IMemoryCache<span class="token punctuation">></span></span></span><span class="token punctuation">(</span>_ <span class="token operator">=></span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MemoryCache</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">MemoryCacheOptions</span> <span class="token punctuation">{</span> SizeLimit <span class="token operator">=</span> <span class="token number">10000</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div></article><div class="content-toolbar"><a href="https://github.com/graphql-dotnet/graphql-dotnet/edit/master/docs2/site/docs/guides/dataloader.md" rel="noopener noreferrer" target="_blank">Edit this page on GitHub</a></div></div><div class="nav"><nav><ul><li><span>Getting Started</span><nav><ul><li><a class="" href="/docs/getting-started/introduction">Introduction</a></li><li><a class="" href="/docs/getting-started/installation">Installation</a></li><li><a class="" href="/docs/getting-started/graphiql">GraphiQL</a></li><li><a class="" href="/docs/getting-started/altair-graphql">Altair GraphQL</a></li><li><a class="" href="/docs/getting-started/queries">Queries</a></li><li><a class="" href="/docs/getting-started/schema-types">Schema Types</a></li><li><a class="" href="/docs/getting-started/custom-scalars">Custom Scalars</a></li><li><a class="" href="/docs/getting-started/lists-non-null">Lists and Non-Null</a></li><li><a class="" href="/docs/getting-started/arguments">Arguments</a></li><li><a class="" href="/docs/getting-started/aliases">Aliases</a></li><li><a class="" href="/docs/getting-started/fragments">Fragments</a></li><li><a class="" href="/docs/getting-started/variables">Variables</a></li><li><a class="" href="/docs/getting-started/directives">Directives</a></li><li><a class="" href="/docs/getting-started/mutations">Mutations</a></li><li><a class="" href="/docs/getting-started/interfaces">Interfaces</a></li><li><a class="" href="/docs/getting-started/unions">Unions</a></li><li><a class="" href="/docs/getting-started/subscriptions">Subscriptions</a></li><li><a class="" href="/docs/getting-started/query-validation">Query Validation</a></li><li><a class="" href="/docs/getting-started/query-organization">Query Organization</a></li><li><a class="" href="/docs/getting-started/user-context">User Context</a></li><li><a class="" href="/docs/getting-started/errors">Error Handling</a></li><li><a class="" href="/docs/getting-started/dependency-injection">Dependency Injection</a></li><li><a class="" href="/docs/getting-started/databases">Databases</a></li><li><a class="" href="/docs/getting-started/malicious-queries">Malicious Queries</a></li><li><a class="" href="/docs/getting-started/metadata">Object/Field Metadata</a></li><li><a class="" href="/docs/getting-started/field-middleware">Field Middleware</a></li><li><a class="" href="/docs/getting-started/metrics">Metrics</a></li><li><a class="" href="/docs/getting-started/authorization">Authorization</a></li><li><a class="" href="/docs/getting-started/relay">Relay</a></li><li><a class="" href="/docs/getting-started/global-switches">Global Switches</a></li></ul></nav></li><li><span>Guides</span><nav><ul><li><a class="" href="/docs/guides/serialization">Serialization</a></li><li><a class="active" href="/docs/guides/dataloader">Dataloader</a></li><li><a class="" href="/docs/guides/schema-generation">Schema Generation</a></li><li><a class="" href="/docs/guides/known-issues">Known Issues &amp; FAQ</a></li><li><a class="" href="/docs/guides/links">Links</a></li><li><a class="" href="/docs/guides/document-caching">Document Caching</a></li></ul></nav></li><li><span>Migration Guides</span><nav><ul><li><a class="" href="/docs/migrations/migration7">Migration Guide [v5 -&gt; v7]</a></li><li><a class="" href="/docs/migrations/migration5">Migration Guide [v4 -&gt; v5]</a></li><li><a class="" href="/docs/migrations/migration4">Migration Guide [v3 -&gt; v4]</a></li><li><a class="" href="/docs/migrations/migration3">Migration Guide [v2 -&gt; v3]</a></li><li><a class="" href="/docs/migrations/migration2">Migration Guide [v0.17.x -&gt; v2]</a></li><li><a class="" href="/docs/migrations/v0_11_0">Migration Guide [v0.11.0]</a></li><li><a class="" href="/docs/migrations/v0_8_0">Migration Guide [v0.8.0]</a></li></ul></nav></li></ul></nav></div></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-25b650787e17e3ebc069.js","95710047193689":"component---site-pages-landing-js-7a04f3721ec3f8b3df00.js","28613242278168":"component---src-templates-docs-page-js-8e21cb098d5f49b9ad94.js","162898551421021":"component---src-pages-404-js-dafbfbd345a265f9fe6e.js","60335399758886":"path----f30409f551ede979d792.js","142629428675168":"path---index-6b1dcdab0a774a86ff50.js","194669561623365":"path---docs-getting-started-introduction-6eec16ba80ab9791beb7.js","7936910712040":"path---docs-getting-started-installation-47d40962aa0cbc105411.js","86643674157860":"path---docs-getting-started-graphiql-f33bd2db8b9e17e05b5c.js","53507852050045":"path---docs-getting-started-altair-graphql-432e07418ea18f50bbec.js","143391023720279":"path---docs-getting-started-queries-5328754a7f87dd890944.js","202354100065884":"path---docs-getting-started-schema-types-994d488eef99e385cbd9.js","266142771958950":"path---docs-getting-started-custom-scalars-90d34229c4ed8325da7f.js","56185524266781":"path---docs-getting-started-lists-non-null-e685364a0af4c21096f9.js","76576268814232":"path---docs-getting-started-arguments-f239e855c1c0b617feec.js","202043887933404":"path---docs-getting-started-aliases-70e6a221c3b60856c9ce.js","157702184900489":"path---docs-getting-started-fragments-b78adb5f2a55e1757268.js","44712706562510":"path---docs-getting-started-variables-e625c38a650cae282cd1.js","244442750240678":"path---docs-getting-started-directives-a595151c86612aaa8096.js","114361466534084":"path---docs-getting-started-mutations-4e7a8b45e0eba80b5ed4.js","133838580703967":"path---docs-getting-started-interfaces-0a406b155ee54eabdea5.js","53220472400125":"path---docs-getting-started-unions-00f581913ae18e4f19d7.js","278627754389952":"path---docs-getting-started-subscriptions-f4922cb5e8ce728f70a5.js","107167650384582":"path---docs-getting-started-query-validation-31983a197b4de32bb965.js","11491794978075":"path---docs-getting-started-query-organization-b1f0ec6fc2081814e0be.js","171719905287791":"path---docs-getting-started-user-context-e70898275b60df8b8511.js","75494656540334":"path---docs-getting-started-errors-01f1d83f3a0925194981.js","178698305269250":"path---docs-getting-started-dependency-injection-1944c01e772ff61d4613.js","75420749601626":"path---docs-getting-started-databases-8c247e11852995057bce.js","55192516056771":"path---docs-getting-started-malicious-queries-185e69437d513265402a.js","33904618880309":"path---docs-getting-started-metadata-73a21a665ef90a6bb712.js","131465737246961":"path---docs-getting-started-field-middleware-cac25ce3d7089d0c6765.js","185577185973635":"path---docs-getting-started-metrics-aa1d9bade38981a564aa.js","271764429786961":"path---docs-getting-started-authorization-50c3e41bd97ca2699b0e.js","71981178235569":"path---docs-getting-started-relay-ffee045935c5c5403cd5.js","167079278695343":"path---docs-getting-started-global-switches-70c4cf342a0d92f21259.js","970605649915":"path---docs-guides-serialization-18b0fc9aa1534af202e0.js","67274500541493":"path---docs-guides-dataloader-e71508790d18d3d143bb.js","254760750072238":"path---docs-guides-schema-generation-0387bd7d86b48ed53440.js","260838844694584":"path---docs-guides-known-issues-6253551f8018b5906596.js","139372590924694":"path---docs-guides-links-23fe4eb9d559d9c8dfe5.js","107626090068759":"path---docs-guides-document-caching-dbcd362bef4c638df8f2.js","171986746120192":"path---docs-migrations-migration-7-a6f65fa87d0943db240e.js","169038957085601":"path---docs-migrations-migration-5-3cefac06106f7ee1d466.js","57783942601805":"path---docs-migrations-migration-4-ddf2740029240c63307d.js","170816503279010":"path---docs-migrations-migration-3-592f267ac70d938bd515.js","87071238410674":"path---docs-migrations-migration-2-12e6d729190fab470be4.js","129554874384426":"path---docs-migrations-v-0-11-0-43992d4826c517cbc95e.js","179521343418354":"path---docs-migrations-v-0-8-0-711ed55bd1278e1d6a97.js","254022195166212":"path---404-a0e39f21c11f6a62c5ab.js","178698757827068":"path---404-html-a0e39f21c11f6a62c5ab.js","114276838955818":"component---src-layouts-index-js-e8e2ac6da0b3fd0e25d9.js"}/*]]>*/</script><script>/*<![CDATA[*/["/commons-a7cf6837d3c24c1c9d2a.js","/app-25b650787e17e3ebc069.js","/path---docs-guides-dataloader-e71508790d18d3d143bb.js","/component---src-templates-docs-page-js-8e21cb098d5f49b9ad94.js","/component---src-layouts-index-js-e8e2ac6da0b3fd0e25d9.js"].forEach(function(s){document.write('<script src="'+s+'" defer></'+'script>')})/*]]>*/</script></body></html>