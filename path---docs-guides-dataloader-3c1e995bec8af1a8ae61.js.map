{"version":3,"sources":["webpack:///path---docs-guides-dataloader-3c1e995bec8af1a8ae61.js","webpack:///./.cache/json/docs-guides-dataloader.json"],"names":["webpackJsonp","334","module","exports","data","markdownRemark","html","fields","relativePath","site","siteMetadata","githubEditUrl","pathContext"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,gBAAkBC,KAAA;AAA831CC,QAA8VC,aAAA,8BAA4CC,MAASC,cAAgBC,cAAA,6EAA4FC,aAAgBJ,aAAA","file":"path---docs-guides-dataloader-3c1e995bec8af1a8ae61.js","sourcesContent":["webpackJsonp([67274500541493],{\n\n/***/ 334:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"markdownRemark\":{\"html\":\"<h1 id=\\\"dataloader\\\"><a href=\\\"#dataloader\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>DataLoader</h1>\\n<p>GraphQL.NET includes an implementation of Facebook's <a href=\\\"https://github.com/facebook/dataloader\\\">DataLoader</a> within the\\n<a href=\\\"https://www.nuget.org/packages/GraphQL.DataLoader\\\"><code class=\\\"language-text\\\">GraphQL.DataLoader</code></a> NuGet package.</p>\\n<p>Consider a GraphQL query like this:</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"graphql\\\">\\n      <pre class=\\\"language-graphql\\\"><code class=\\\"language-graphql\\\"><span class=\\\"token punctuation\\\">{</span>\\n\\torders<span class=\\\"token punctuation\\\">(</span><span class=\\\"token attr-name\\\">date</span><span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"2017-01-01\\\"</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\t\\torderId\\n\\t\\tdate\\n\\t\\tuser <span class=\\\"token punctuation\\\">{</span>\\n\\t\\t\\tuserId\\n\\t\\t\\tfirstName\\n\\t\\t\\tlastName\\n\\t\\t<span class=\\\"token punctuation\\\">}</span>\\n\\t<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>When the query is executed, first a list of orders is fetched. Then for each order, the associated user must also be fetched. If each user is fetched one-by-one, this would get more inefficient as the number of orders (N) grows. This is known as the N+1 problem. If there are 50 orders (N = 50), 51 separate requests would be made to load this data.</p>\\n<p>A DataLoader helps in two ways:</p>\\n<ol>\\n<li>Similar operations are batched together. This can make fetching data over a network much more efficient.</li>\\n<li>Fetched values are cached so if they are requested again, the cached value is returned.</li>\\n</ol>\\n<p>In the example above, a using a DataLoader will allow us to batch together all of the requests for the users. So there would be 1 request to retrieve the list of orders and 1 request to load all users associated with those orders. This would always be a total of 2 requests rather than N+1.</p>\\n<h2 id=\\\"setup\\\"><a href=\\\"#setup\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Setup</h2>\\n<ol>\\n<li>Register <code class=\\\"language-text\\\">IDataLoaderContextAccessor</code> in your IoC container.</li>\\n<li>Register <code class=\\\"language-text\\\">DataLoaderDocumentListener</code> in your IoC container.</li>\\n</ol>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\">services<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">AddSingleton</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>IDataLoaderContextAccessor<span class=\\\"token punctuation\\\">,</span> DataLoaderContextAccessor<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\nservices<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">AddSingleton</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>DataLoaderDocumentListener<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<ol start=\\\"3\\\">\\n<li>Hook up your GraphQL schema to your IoC container.</li>\\n</ol>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">MySchema</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token type-list\\\"><span class=\\\"token class-name\\\">Schema</span></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">MySchema</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IServiceProvider</span> services<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">base</span><span class=\\\"token punctuation\\\">(</span>services<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\">services<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">AddSingleton</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>MySchema<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<ol start=\\\"4\\\">\\n<li>Add the <code class=\\\"language-text\\\">DataLoaderDocumentListener</code> to the <code class=\\\"language-text\\\">DocumentExecuter</code>.</li>\\n</ol>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> listener <span class=\\\"token operator\\\">=</span> Services<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetRequiredService</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>DataLoaderDocumentListener<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> executer <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token constructor-invocation class-name\\\">DocumentExecuter</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> result <span class=\\\"token operator\\\">=</span> executer<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ExecuteAsync</span><span class=\\\"token punctuation\\\">(</span>opts <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n\\n\\t<span class=\\\"token range operator\\\">..</span><span class=\\\"token punctuation\\\">.</span>\\n\\n\\topts<span class=\\\"token punctuation\\\">.</span>Listeners<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Add</span><span class=\\\"token punctuation\\\">(</span>listener<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h2 id=\\\"usage\\\"><a href=\\\"#usage\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Usage</h2>\\n<p>First, inject the <code class=\\\"language-text\\\">IDataLoaderContextAccessor</code> into your GraphQL type class.</p>\\n<p>Then use the <code class=\\\"language-text\\\">Context</code> property on the accessor to get the current <code class=\\\"language-text\\\">DataLoaderContext</code>. The <code class=\\\"language-text\\\">DataLoaderDocumentListener</code> configured above ensures that each request will have its own context instance.</p>\\n<p>Use one of the \\\"GetOrAddLoader\\\" methods on the <code class=\\\"language-text\\\">DataLoaderContext</code>. These methods all require a string key to uniquely identify each loader. They also require a delegate for fetching the data. Each method will get an existing loader or add a new one, identified by the string key. Each method has various overloads to support different ways to load and map data with the keys.</p>\\n<p>Call <code class=\\\"language-text\\\">LoadAsync()</code> on the data loader. This will queue the request and return a <code class=\\\"language-text\\\">IDataLoaderResult&lt;T&gt;</code>. If the result has already been cached, the returned value will be pulled from the cache.</p>\\n<p>The <code class=\\\"language-text\\\">ExecutionStrategy</code> will dispatch queued data loaders after all other pending fields have been resolved.</p>\\n<p>If your code requires an asynchronous call prior to queuing the data loader, use the <code class=\\\"language-text\\\">ResolveAsync</code> field builder method to return a\\n<code class=\\\"language-text\\\">Task&lt;IDataLoaderResult&lt;T&gt;&gt;</code>. The execution strategy will start executing the asynchronous code as soon as the field resolver executes.\\nOnce the <code class=\\\"language-text\\\">IDataLoaderResult&lt;T&gt;</code> is retrieved from the asynchronous task, the data loader will be queued to be dispatched once all\\nother pending fields have been resolved.</p>\\n<p>To execute code within the resolver after the data loader has retrieved the data, pass a delegate to the <code class=\\\"language-text\\\">Then</code> extension\\nmethod of the returned <code class=\\\"language-text\\\">IDataLoaderResult&lt;T&gt;</code>. You can use a synchronous or asynchronous delegate, and it can return another\\n<code class=\\\"language-text\\\">IDataLoaderResult&lt;T&gt;</code> if you wish to chain dataloaders together. This may result in the field builder's Resolve delegate\\nsignature looking like <code class=\\\"language-text\\\">IDataLoaderResult&lt;IDataLoaderResult&lt;T&gt;&gt;</code>, which is correct and will be handled properly by the execution strategy.</p>\\n<h2 id=\\\"examples\\\"><a href=\\\"#examples\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Examples</h2>\\n<p>This is an example of using a DataLoader to batch requests for loading items by a key. <code class=\\\"language-text\\\">LoadAsync()</code> is called by the field resolver for each Order. <code class=\\\"language-text\\\">IUsersStore.GetUsersByIdAsync()</code> will be called with the batch of userIds that were requested.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">OrderType</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token type-list\\\"><span class=\\\"token class-name\\\">ObjectGraphType<span class=\\\"token punctuation\\\">&lt;</span>Order<span class=\\\"token punctuation\\\">></span></span></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">OrderType</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span> accessor<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IUsersStore</span> users<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token range operator\\\">..</span><span class=\\\"token punctuation\\\">.</span>\\n\\n        <span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">Field</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>UserType<span class=\\\"token punctuation\\\">,</span> User<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Name</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"User\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ResolveAsync</span><span class=\\\"token punctuation\\\">(</span>context <span class=\\\"token operator\\\">=></span>\\n            <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token comment\\\">// Get or add a batch loader with the key \\\"GetUsersById\\\"</span>\\n                <span class=\\\"token comment\\\">// The loader will call GetUsersByIdAsync for each batch of keys</span>\\n                <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> loader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetOrAddBatchLoader</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> User<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetUsersById\\\"</span><span class=\\\"token punctuation\\\">,</span> users<span class=\\\"token punctuation\\\">.</span>GetUsersByIdAsync<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token comment\\\">// Add this UserId to the pending keys to fetch</span>\\n                <span class=\\\"token comment\\\">// The execution strategy will trigger the data loader to fetch the data via GetUsersByIdAsync() at the</span>\\n                <span class=\\\"token comment\\\">//   appropriate time, and the field will be resolved with an instance of User once GetUsersByIdAsync()</span>\\n                <span class=\\\"token comment\\\">//   returns with the batched results</span>\\n                <span class=\\\"token keyword\\\">return</span> loader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span>context<span class=\\\"token punctuation\\\">.</span>Source<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">interface</span> <span class=\\\"token class-name\\\">IUsersStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// This will be called by the loader for all pending keys</span>\\n    <span class=\\\"token comment\\\">// Note that fetch delegates can accept a CancellationToken parameter or not</span>\\n    <span class=\\\"token return-type class-name\\\">Task<span class=\\\"token punctuation\\\">&lt;</span>IDictionary<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> User<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token function\\\">GetUsersByIdAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IEnumerable<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">></span></span> userIds<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">CancellationToken</span> cancellationToken<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>This is an example of using a DataLoader to batch requests for loading a collection of items by a key. This is used when a key may be associated with more than one item. <code class=\\\"language-text\\\">LoadAsync()</code> is called by the field resolver for each User. A User can have zero to many Orders. <code class=\\\"language-text\\\">IOrdersStore.GetOrdersByUserIdAsync</code> will be called with a batch of userIds that have been requested.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">UserType</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token type-list\\\"><span class=\\\"token class-name\\\">ObjectGraphType<span class=\\\"token punctuation\\\">&lt;</span>User<span class=\\\"token punctuation\\\">></span></span></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">UserType</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span> accessor<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IOrdersStore</span> orders<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token range operator\\\">..</span><span class=\\\"token punctuation\\\">.</span>\\n\\n        <span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">Field</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>ListGraphType<span class=\\\"token punctuation\\\">&lt;</span>OrderType<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">,</span> IEnumerable<span class=\\\"token punctuation\\\">&lt;</span>Order<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Name</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Orders\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ResolveAsync</span><span class=\\\"token punctuation\\\">(</span>ctx <span class=\\\"token operator\\\">=></span>\\n            <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token comment\\\">// Get or add a collection batch loader with the key \\\"GetOrdersByUserId\\\"</span>\\n                <span class=\\\"token comment\\\">// The loader will call GetOrdersByUserIdAsync with a batch of keys</span>\\n                <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> ordersLoader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetOrAddCollectionBatchLoader</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> Order<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetOrdersByUserId\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                    orders<span class=\\\"token punctuation\\\">.</span>GetOrdersByUserIdAsync<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token comment\\\">// Add this UserId to the pending keys to fetch data for</span>\\n                <span class=\\\"token comment\\\">// The execution strategy will trigger the data loader to fetch the data via GetOrdersByUserId() at the</span>\\n                <span class=\\\"token comment\\\">//   appropriate time, and the field will be resolved with an instance of IEnumerable&lt;Order> once</span>\\n                <span class=\\\"token comment\\\">//   GetOrdersByUserId() returns with the batched results</span>\\n                <span class=\\\"token keyword\\\">return</span> ordersLoader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span>ctx<span class=\\\"token punctuation\\\">.</span>Source<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">OrdersStore</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token type-list\\\"><span class=\\\"token class-name\\\">IOrdersStore</span></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">async</span> <span class=\\\"token return-type class-name\\\">Task<span class=\\\"token punctuation\\\">&lt;</span>ILookup<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> Order<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token function\\\">GetOrdersByUserIdAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IEnumerable<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">></span></span> userIds<span class=\\\"token punctuation\\\">)</span>\\n\\t<span class=\\\"token punctuation\\\">{</span>\\n\\t\\t<span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> orders <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">await</span> <span class=\\\"token range operator\\\">..</span><span class=\\\"token punctuation\\\">.</span> <span class=\\\"token comment\\\">// load data from database</span>\\n\\n\\t\\t<span class=\\\"token keyword\\\">return</span> orders\\n\\t\\t\\t<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ToLookup</span><span class=\\\"token punctuation\\\">(</span>x <span class=\\\"token operator\\\">=></span> x<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\t<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>This is an example of using a DataLoader without batching. This could be useful if the data may be requested multiple times. The result will be cached the first time. Subsequent calls to <code class=\\\"language-text\\\">LoadAsync()</code> will return the cached result.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">QueryType</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token type-list\\\"><span class=\\\"token class-name\\\">ObjectGraphType</span></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">QueryType</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span> accessor<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IUsersStore</span> users<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">Field</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>ListGraphType<span class=\\\"token punctuation\\\">&lt;</span>UserType<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">,</span> IEnumerable<span class=\\\"token punctuation\\\">&lt;</span>User<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Name</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Users\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Description</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Get all Users\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ResolveAsync</span><span class=\\\"token punctuation\\\">(</span>ctx <span class=\\\"token operator\\\">=></span>\\n            <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token comment\\\">// Get or add a loader with the key \\\"GetAllUsers\\\"</span>\\n                <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> loader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">GetOrAddLoader</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetAllUsers\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                    <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> users<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">GetAllUsersAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token comment\\\">// Prepare the load operation</span>\\n                <span class=\\\"token comment\\\">// If the result is cached, a completed Task&lt;IEnumerable&lt;User>> will be returned</span>\\n                <span class=\\\"token keyword\\\">return</span> loader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">interface</span> <span class=\\\"token class-name\\\">IUsersStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token return-type class-name\\\">Task<span class=\\\"token punctuation\\\">&lt;</span>IEnumerable<span class=\\\"token punctuation\\\">&lt;</span>User<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token function\\\">GetAllUsersAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>This is an example of using two chained DataLoaders to batch requests together, with asynchronous code before the data loaders execute, and post-processing afterwards.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">UserType</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token type-list\\\"><span class=\\\"token class-name\\\">ObjectGraphType<span class=\\\"token punctuation\\\">&lt;</span>User<span class=\\\"token punctuation\\\">></span></span></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">UserType</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span> accessor<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IUsersStore</span> users<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IOrdersStore</span> orders<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IItemsStore</span> items<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token range operator\\\">..</span><span class=\\\"token punctuation\\\">.</span>\\n\\n        <span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">Field</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>ListGraphType<span class=\\\"token punctuation\\\">&lt;</span>ItemType<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">,</span> IEnumerable<span class=\\\"token punctuation\\\">&lt;</span>Item<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Name</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"OrderedItems\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ResolveAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">async</span> context <span class=\\\"token operator\\\">=></span>\\n            <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token comment\\\">// Asynchronously authenticate</span>\\n                <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> valid <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">await</span> users<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">CanViewOrders</span><span class=\\\"token punctuation\\\">(</span>context<span class=\\\"token punctuation\\\">.</span>Source<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span>valid<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">;</span>\\n                \\n                <span class=\\\"token comment\\\">// Get or add a collection batch loader with the key \\\"GetOrdersByUserId\\\"</span>\\n                <span class=\\\"token comment\\\">// The loader will call GetOrdersByUserIdAsync with a batch of keys</span>\\n                <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> ordersLoader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetOrAddCollectionBatchLoader</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> Order<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetOrdersByUserId\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                    orders<span class=\\\"token punctuation\\\">.</span>GetOrdersByUserIdAsync<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> ordersResult <span class=\\\"token operator\\\">=</span> ordersLoader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span>context<span class=\\\"token punctuation\\\">.</span>Source<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token comment\\\">// Once the orders have been retrieved by the first data loader, feed the order IDs into</span>\\n                <span class=\\\"token comment\\\">//   the second data loader</span>\\n                <span class=\\\"token keyword\\\">return</span> ordersResult<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>orders<span class=\\\"token punctuation\\\">,</span> cancellationToken<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span>\\n                <span class=\\\"token punctuation\\\">{</span>\\n                    <span class=\\\"token comment\\\">// Collect all of the order IDs</span>\\n                    <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> orderIds <span class=\\\"token operator\\\">=</span> orders<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Select</span><span class=\\\"token punctuation\\\">(</span>o <span class=\\\"token operator\\\">=></span> o<span class=\\\"token punctuation\\\">.</span>Id<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                    <span class=\\\"token comment\\\">// Get or add a collection batch loader with the key \\\"GetItemsByOrderId\\\"</span>\\n                    <span class=\\\"token comment\\\">// The loader will call GetItemsByOrderId with a batch of keys</span>\\n                    <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> itemsLoader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetOrAddCollectionBatchLoader</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> Item<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetItemsByOrderId\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                        items<span class=\\\"token punctuation\\\">.</span>GetItemsByOrderIdAsync<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                    <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> itemsResults <span class=\\\"token operator\\\">=</span> itemsLoader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span>orderIds<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                    <span class=\\\"token comment\\\">// itemsResults is of type IDataLoaderResult&lt;IEnumerable&lt;Item>[]> so the array needs to be flattened</span>\\n                    <span class=\\\"token comment\\\">//   before returning it back to the query</span>\\n                    <span class=\\\"token keyword\\\">return</span> itemsResults<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Then</span><span class=\\\"token punctuation\\\">(</span>itemResultSet <span class=\\\"token operator\\\">=></span>\\n                    <span class=\\\"token punctuation\\\">{</span>\\n                        <span class=\\\"token comment\\\">// Flatten the results after the second dataloader has finished</span>\\n                        <span class=\\\"token keyword\\\">return</span> flattenedResults <span class=\\\"token operator\\\">=</span> itemResultSet<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">SelectMany</span><span class=\\\"token punctuation\\\">(</span>x <span class=\\\"token operator\\\">=></span> x<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">interface</span> <span class=\\\"token class-name\\\">IUsersStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// This will be called for each call to OrderedItems, prior to any data loader execution</span>\\n    <span class=\\\"token return-type class-name\\\">Task<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">bool</span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token function\\\">CanViewOrders</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">int</span></span> userId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">interface</span> <span class=\\\"token class-name\\\">IOrdersStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// This will be called by the \\\"order\\\" loader for all pending keys</span>\\n    <span class=\\\"token comment\\\">// Note that fetch delegates can accept a CancellationToken parameter or not</span>\\n    <span class=\\\"token return-type class-name\\\">Task<span class=\\\"token punctuation\\\">&lt;</span>ILookup<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> Order<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token function\\\">GetOrdersByUserIdAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IEnumerable<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">></span></span> userIds<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">CancellationToken</span> cancellationToken<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">interface</span> <span class=\\\"token class-name\\\">IItemsStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// This will be called by the \\\"item\\\" loader for all pending keys</span>\\n    <span class=\\\"token comment\\\">// Note that fetch delegates can accept a CancellationToken parameter or not</span>\\n    <span class=\\\"token return-type class-name\\\">Task<span class=\\\"token punctuation\\\">&lt;</span>ILookup<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> Item<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token function\\\">GetItemsByOrderIdAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IEnumerable<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">></span></span> orderIds<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">CancellationToken</span> cancellationToken<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<blockquote>\\n<p>See this <a href=\\\"https://fiyazhasan.me/graphql-with-net-core-part-xi-dataloader/\\\">blog series</a> for an in depth example using Entity Framework.</p>\\n</blockquote>\\n<h2 id=\\\"exceptions\\\"><a href=\\\"#exceptions\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Exceptions</h2>\\n<p>Exceptions within data loaders' fetch delegates are passed back to the execution strategy for all associated fields.\\nIf you have a need to capture exceptions raised by the fetch delegate, create a <code class=\\\"language-text\\\">new SimpleDataLoader&lt;T&gt;</code> within\\nyour field resolver (do not use the <code class=\\\"language-text\\\">IDataLoaderContextAccessor</code> for this) and have its fetch delegate await the\\n<code class=\\\"language-text\\\">IDataLoaderResult&lt;T&gt;.GetResultAsync</code> method of the result obtained from the first data loader within a try/catch\\nblock. Return the result of the simple data loader's <code class=\\\"language-text\\\">LoadAsync()</code> function to the field resolver.  The data loader\\nwill still load at the appropriate time, and you can handle exceptions as desired.</p>\",\"fields\":{\"relativePath\":\"docs/guides/dataloader.md\"}},\"site\":{\"siteMetadata\":{\"githubEditUrl\":\"https://github.com/graphql-dotnet/graphql-dotnet/edit/master/docs2/site\"}}},\"pathContext\":{\"relativePath\":\"docs/guides/dataloader.md\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---docs-guides-dataloader-3c1e995bec8af1a8ae61.js","module.exports = {\"data\":{\"markdownRemark\":{\"html\":\"<h1 id=\\\"dataloader\\\"><a href=\\\"#dataloader\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>DataLoader</h1>\\n<p>GraphQL.NET includes an implementation of Facebook's <a href=\\\"https://github.com/facebook/dataloader\\\">DataLoader</a> within the\\n<a href=\\\"https://www.nuget.org/packages/GraphQL.DataLoader\\\"><code class=\\\"language-text\\\">GraphQL.DataLoader</code></a> NuGet package.</p>\\n<p>Consider a GraphQL query like this:</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"graphql\\\">\\n      <pre class=\\\"language-graphql\\\"><code class=\\\"language-graphql\\\"><span class=\\\"token punctuation\\\">{</span>\\n\\torders<span class=\\\"token punctuation\\\">(</span><span class=\\\"token attr-name\\\">date</span><span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"2017-01-01\\\"</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\t\\torderId\\n\\t\\tdate\\n\\t\\tuser <span class=\\\"token punctuation\\\">{</span>\\n\\t\\t\\tuserId\\n\\t\\t\\tfirstName\\n\\t\\t\\tlastName\\n\\t\\t<span class=\\\"token punctuation\\\">}</span>\\n\\t<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>When the query is executed, first a list of orders is fetched. Then for each order, the associated user must also be fetched. If each user is fetched one-by-one, this would get more inefficient as the number of orders (N) grows. This is known as the N+1 problem. If there are 50 orders (N = 50), 51 separate requests would be made to load this data.</p>\\n<p>A DataLoader helps in two ways:</p>\\n<ol>\\n<li>Similar operations are batched together. This can make fetching data over a network much more efficient.</li>\\n<li>Fetched values are cached so if they are requested again, the cached value is returned.</li>\\n</ol>\\n<p>In the example above, a using a DataLoader will allow us to batch together all of the requests for the users. So there would be 1 request to retrieve the list of orders and 1 request to load all users associated with those orders. This would always be a total of 2 requests rather than N+1.</p>\\n<h2 id=\\\"setup\\\"><a href=\\\"#setup\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Setup</h2>\\n<ol>\\n<li>Register <code class=\\\"language-text\\\">IDataLoaderContextAccessor</code> in your IoC container.</li>\\n<li>Register <code class=\\\"language-text\\\">DataLoaderDocumentListener</code> in your IoC container.</li>\\n</ol>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\">services<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">AddSingleton</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>IDataLoaderContextAccessor<span class=\\\"token punctuation\\\">,</span> DataLoaderContextAccessor<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\nservices<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">AddSingleton</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>DataLoaderDocumentListener<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<ol start=\\\"3\\\">\\n<li>Hook up your GraphQL schema to your IoC container.</li>\\n</ol>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">MySchema</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token type-list\\\"><span class=\\\"token class-name\\\">Schema</span></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">MySchema</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IServiceProvider</span> services<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">base</span><span class=\\\"token punctuation\\\">(</span>services<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\">services<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">AddSingleton</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>MySchema<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<ol start=\\\"4\\\">\\n<li>Add the <code class=\\\"language-text\\\">DataLoaderDocumentListener</code> to the <code class=\\\"language-text\\\">DocumentExecuter</code>.</li>\\n</ol>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> listener <span class=\\\"token operator\\\">=</span> Services<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetRequiredService</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>DataLoaderDocumentListener<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> executer <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token constructor-invocation class-name\\\">DocumentExecuter</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> result <span class=\\\"token operator\\\">=</span> executer<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ExecuteAsync</span><span class=\\\"token punctuation\\\">(</span>opts <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n\\n\\t<span class=\\\"token range operator\\\">..</span><span class=\\\"token punctuation\\\">.</span>\\n\\n\\topts<span class=\\\"token punctuation\\\">.</span>Listeners<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Add</span><span class=\\\"token punctuation\\\">(</span>listener<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h2 id=\\\"usage\\\"><a href=\\\"#usage\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Usage</h2>\\n<p>First, inject the <code class=\\\"language-text\\\">IDataLoaderContextAccessor</code> into your GraphQL type class.</p>\\n<p>Then use the <code class=\\\"language-text\\\">Context</code> property on the accessor to get the current <code class=\\\"language-text\\\">DataLoaderContext</code>. The <code class=\\\"language-text\\\">DataLoaderDocumentListener</code> configured above ensures that each request will have its own context instance.</p>\\n<p>Use one of the \\\"GetOrAddLoader\\\" methods on the <code class=\\\"language-text\\\">DataLoaderContext</code>. These methods all require a string key to uniquely identify each loader. They also require a delegate for fetching the data. Each method will get an existing loader or add a new one, identified by the string key. Each method has various overloads to support different ways to load and map data with the keys.</p>\\n<p>Call <code class=\\\"language-text\\\">LoadAsync()</code> on the data loader. This will queue the request and return a <code class=\\\"language-text\\\">IDataLoaderResult&lt;T&gt;</code>. If the result has already been cached, the returned value will be pulled from the cache.</p>\\n<p>The <code class=\\\"language-text\\\">ExecutionStrategy</code> will dispatch queued data loaders after all other pending fields have been resolved.</p>\\n<p>If your code requires an asynchronous call prior to queuing the data loader, use the <code class=\\\"language-text\\\">ResolveAsync</code> field builder method to return a\\n<code class=\\\"language-text\\\">Task&lt;IDataLoaderResult&lt;T&gt;&gt;</code>. The execution strategy will start executing the asynchronous code as soon as the field resolver executes.\\nOnce the <code class=\\\"language-text\\\">IDataLoaderResult&lt;T&gt;</code> is retrieved from the asynchronous task, the data loader will be queued to be dispatched once all\\nother pending fields have been resolved.</p>\\n<p>To execute code within the resolver after the data loader has retrieved the data, pass a delegate to the <code class=\\\"language-text\\\">Then</code> extension\\nmethod of the returned <code class=\\\"language-text\\\">IDataLoaderResult&lt;T&gt;</code>. You can use a synchronous or asynchronous delegate, and it can return another\\n<code class=\\\"language-text\\\">IDataLoaderResult&lt;T&gt;</code> if you wish to chain dataloaders together. This may result in the field builder's Resolve delegate\\nsignature looking like <code class=\\\"language-text\\\">IDataLoaderResult&lt;IDataLoaderResult&lt;T&gt;&gt;</code>, which is correct and will be handled properly by the execution strategy.</p>\\n<h2 id=\\\"examples\\\"><a href=\\\"#examples\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Examples</h2>\\n<p>This is an example of using a DataLoader to batch requests for loading items by a key. <code class=\\\"language-text\\\">LoadAsync()</code> is called by the field resolver for each Order. <code class=\\\"language-text\\\">IUsersStore.GetUsersByIdAsync()</code> will be called with the batch of userIds that were requested.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">OrderType</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token type-list\\\"><span class=\\\"token class-name\\\">ObjectGraphType<span class=\\\"token punctuation\\\">&lt;</span>Order<span class=\\\"token punctuation\\\">></span></span></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">OrderType</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span> accessor<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IUsersStore</span> users<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token range operator\\\">..</span><span class=\\\"token punctuation\\\">.</span>\\n\\n        <span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">Field</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>UserType<span class=\\\"token punctuation\\\">,</span> User<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Name</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"User\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ResolveAsync</span><span class=\\\"token punctuation\\\">(</span>context <span class=\\\"token operator\\\">=></span>\\n            <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token comment\\\">// Get or add a batch loader with the key \\\"GetUsersById\\\"</span>\\n                <span class=\\\"token comment\\\">// The loader will call GetUsersByIdAsync for each batch of keys</span>\\n                <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> loader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetOrAddBatchLoader</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> User<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetUsersById\\\"</span><span class=\\\"token punctuation\\\">,</span> users<span class=\\\"token punctuation\\\">.</span>GetUsersByIdAsync<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token comment\\\">// Add this UserId to the pending keys to fetch</span>\\n                <span class=\\\"token comment\\\">// The execution strategy will trigger the data loader to fetch the data via GetUsersByIdAsync() at the</span>\\n                <span class=\\\"token comment\\\">//   appropriate time, and the field will be resolved with an instance of User once GetUsersByIdAsync()</span>\\n                <span class=\\\"token comment\\\">//   returns with the batched results</span>\\n                <span class=\\\"token keyword\\\">return</span> loader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span>context<span class=\\\"token punctuation\\\">.</span>Source<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">interface</span> <span class=\\\"token class-name\\\">IUsersStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// This will be called by the loader for all pending keys</span>\\n    <span class=\\\"token comment\\\">// Note that fetch delegates can accept a CancellationToken parameter or not</span>\\n    <span class=\\\"token return-type class-name\\\">Task<span class=\\\"token punctuation\\\">&lt;</span>IDictionary<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> User<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token function\\\">GetUsersByIdAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IEnumerable<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">></span></span> userIds<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">CancellationToken</span> cancellationToken<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>This is an example of using a DataLoader to batch requests for loading a collection of items by a key. This is used when a key may be associated with more than one item. <code class=\\\"language-text\\\">LoadAsync()</code> is called by the field resolver for each User. A User can have zero to many Orders. <code class=\\\"language-text\\\">IOrdersStore.GetOrdersByUserIdAsync</code> will be called with a batch of userIds that have been requested.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">UserType</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token type-list\\\"><span class=\\\"token class-name\\\">ObjectGraphType<span class=\\\"token punctuation\\\">&lt;</span>User<span class=\\\"token punctuation\\\">></span></span></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">UserType</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span> accessor<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IOrdersStore</span> orders<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token range operator\\\">..</span><span class=\\\"token punctuation\\\">.</span>\\n\\n        <span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">Field</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>ListGraphType<span class=\\\"token punctuation\\\">&lt;</span>OrderType<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">,</span> IEnumerable<span class=\\\"token punctuation\\\">&lt;</span>Order<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Name</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Orders\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ResolveAsync</span><span class=\\\"token punctuation\\\">(</span>ctx <span class=\\\"token operator\\\">=></span>\\n            <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token comment\\\">// Get or add a collection batch loader with the key \\\"GetOrdersByUserId\\\"</span>\\n                <span class=\\\"token comment\\\">// The loader will call GetOrdersByUserIdAsync with a batch of keys</span>\\n                <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> ordersLoader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetOrAddCollectionBatchLoader</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> Order<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetOrdersByUserId\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                    orders<span class=\\\"token punctuation\\\">.</span>GetOrdersByUserIdAsync<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token comment\\\">// Add this UserId to the pending keys to fetch data for</span>\\n                <span class=\\\"token comment\\\">// The execution strategy will trigger the data loader to fetch the data via GetOrdersByUserId() at the</span>\\n                <span class=\\\"token comment\\\">//   appropriate time, and the field will be resolved with an instance of IEnumerable&lt;Order> once</span>\\n                <span class=\\\"token comment\\\">//   GetOrdersByUserId() returns with the batched results</span>\\n                <span class=\\\"token keyword\\\">return</span> ordersLoader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span>ctx<span class=\\\"token punctuation\\\">.</span>Source<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">OrdersStore</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token type-list\\\"><span class=\\\"token class-name\\\">IOrdersStore</span></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">async</span> <span class=\\\"token return-type class-name\\\">Task<span class=\\\"token punctuation\\\">&lt;</span>ILookup<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> Order<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token function\\\">GetOrdersByUserIdAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IEnumerable<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">></span></span> userIds<span class=\\\"token punctuation\\\">)</span>\\n\\t<span class=\\\"token punctuation\\\">{</span>\\n\\t\\t<span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> orders <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">await</span> <span class=\\\"token range operator\\\">..</span><span class=\\\"token punctuation\\\">.</span> <span class=\\\"token comment\\\">// load data from database</span>\\n\\n\\t\\t<span class=\\\"token keyword\\\">return</span> orders\\n\\t\\t\\t<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ToLookup</span><span class=\\\"token punctuation\\\">(</span>x <span class=\\\"token operator\\\">=></span> x<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\t<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>This is an example of using a DataLoader without batching. This could be useful if the data may be requested multiple times. The result will be cached the first time. Subsequent calls to <code class=\\\"language-text\\\">LoadAsync()</code> will return the cached result.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">QueryType</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token type-list\\\"><span class=\\\"token class-name\\\">ObjectGraphType</span></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">QueryType</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span> accessor<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IUsersStore</span> users<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">Field</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>ListGraphType<span class=\\\"token punctuation\\\">&lt;</span>UserType<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">,</span> IEnumerable<span class=\\\"token punctuation\\\">&lt;</span>User<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Name</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Users\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Description</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Get all Users\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ResolveAsync</span><span class=\\\"token punctuation\\\">(</span>ctx <span class=\\\"token operator\\\">=></span>\\n            <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token comment\\\">// Get or add a loader with the key \\\"GetAllUsers\\\"</span>\\n                <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> loader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">GetOrAddLoader</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetAllUsers\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                    <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> users<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">GetAllUsersAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token comment\\\">// Prepare the load operation</span>\\n                <span class=\\\"token comment\\\">// If the result is cached, a completed Task&lt;IEnumerable&lt;User>> will be returned</span>\\n                <span class=\\\"token keyword\\\">return</span> loader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">interface</span> <span class=\\\"token class-name\\\">IUsersStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token return-type class-name\\\">Task<span class=\\\"token punctuation\\\">&lt;</span>IEnumerable<span class=\\\"token punctuation\\\">&lt;</span>User<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token function\\\">GetAllUsersAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>This is an example of using two chained DataLoaders to batch requests together, with asynchronous code before the data loaders execute, and post-processing afterwards.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">UserType</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token type-list\\\"><span class=\\\"token class-name\\\">ObjectGraphType<span class=\\\"token punctuation\\\">&lt;</span>User<span class=\\\"token punctuation\\\">></span></span></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">UserType</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span> accessor<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IUsersStore</span> users<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IOrdersStore</span> orders<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IItemsStore</span> items<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token range operator\\\">..</span><span class=\\\"token punctuation\\\">.</span>\\n\\n        <span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">Field</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span>ListGraphType<span class=\\\"token punctuation\\\">&lt;</span>ItemType<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">,</span> IEnumerable<span class=\\\"token punctuation\\\">&lt;</span>Item<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Name</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"OrderedItems\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ResolveAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">async</span> context <span class=\\\"token operator\\\">=></span>\\n            <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token comment\\\">// Asynchronously authenticate</span>\\n                <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> valid <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">await</span> users<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">CanViewOrders</span><span class=\\\"token punctuation\\\">(</span>context<span class=\\\"token punctuation\\\">.</span>Source<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span>valid<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">;</span>\\n                \\n                <span class=\\\"token comment\\\">// Get or add a collection batch loader with the key \\\"GetOrdersByUserId\\\"</span>\\n                <span class=\\\"token comment\\\">// The loader will call GetOrdersByUserIdAsync with a batch of keys</span>\\n                <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> ordersLoader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetOrAddCollectionBatchLoader</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> Order<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetOrdersByUserId\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                    orders<span class=\\\"token punctuation\\\">.</span>GetOrdersByUserIdAsync<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> ordersResult <span class=\\\"token operator\\\">=</span> ordersLoader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span>context<span class=\\\"token punctuation\\\">.</span>Source<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token comment\\\">// Once the orders have been retrieved by the first data loader, feed the order IDs into</span>\\n                <span class=\\\"token comment\\\">//   the second data loader</span>\\n                <span class=\\\"token keyword\\\">return</span> ordersResult<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>orders<span class=\\\"token punctuation\\\">,</span> cancellationToken<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span>\\n                <span class=\\\"token punctuation\\\">{</span>\\n                    <span class=\\\"token comment\\\">// Collect all of the order IDs</span>\\n                    <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> orderIds <span class=\\\"token operator\\\">=</span> orders<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Select</span><span class=\\\"token punctuation\\\">(</span>o <span class=\\\"token operator\\\">=></span> o<span class=\\\"token punctuation\\\">.</span>Id<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                    <span class=\\\"token comment\\\">// Get or add a collection batch loader with the key \\\"GetItemsByOrderId\\\"</span>\\n                    <span class=\\\"token comment\\\">// The loader will call GetItemsByOrderId with a batch of keys</span>\\n                    <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> itemsLoader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetOrAddCollectionBatchLoader</span><span class=\\\"token generic class-name\\\"><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> Item<span class=\\\"token punctuation\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetItemsByOrderId\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                        items<span class=\\\"token punctuation\\\">.</span>GetItemsByOrderIdAsync<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                    <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> itemsResults <span class=\\\"token operator\\\">=</span> itemsLoader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span>orderIds<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                    <span class=\\\"token comment\\\">// itemsResults is of type IDataLoaderResult&lt;IEnumerable&lt;Item>[]> so the array needs to be flattened</span>\\n                    <span class=\\\"token comment\\\">//   before returning it back to the query</span>\\n                    <span class=\\\"token keyword\\\">return</span> itemsResults<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Then</span><span class=\\\"token punctuation\\\">(</span>itemResultSet <span class=\\\"token operator\\\">=></span>\\n                    <span class=\\\"token punctuation\\\">{</span>\\n                        <span class=\\\"token comment\\\">// Flatten the results after the second dataloader has finished</span>\\n                        <span class=\\\"token keyword\\\">return</span> flattenedResults <span class=\\\"token operator\\\">=</span> itemResultSet<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">SelectMany</span><span class=\\\"token punctuation\\\">(</span>x <span class=\\\"token operator\\\">=></span> x<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">interface</span> <span class=\\\"token class-name\\\">IUsersStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// This will be called for each call to OrderedItems, prior to any data loader execution</span>\\n    <span class=\\\"token return-type class-name\\\">Task<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">bool</span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token function\\\">CanViewOrders</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">int</span></span> userId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">interface</span> <span class=\\\"token class-name\\\">IOrdersStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// This will be called by the \\\"order\\\" loader for all pending keys</span>\\n    <span class=\\\"token comment\\\">// Note that fetch delegates can accept a CancellationToken parameter or not</span>\\n    <span class=\\\"token return-type class-name\\\">Task<span class=\\\"token punctuation\\\">&lt;</span>ILookup<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> Order<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token function\\\">GetOrdersByUserIdAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IEnumerable<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">></span></span> userIds<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">CancellationToken</span> cancellationToken<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">interface</span> <span class=\\\"token class-name\\\">IItemsStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// This will be called by the \\\"item\\\" loader for all pending keys</span>\\n    <span class=\\\"token comment\\\">// Note that fetch delegates can accept a CancellationToken parameter or not</span>\\n    <span class=\\\"token return-type class-name\\\">Task<span class=\\\"token punctuation\\\">&lt;</span>ILookup<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> Item<span class=\\\"token punctuation\\\">></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token function\\\">GetItemsByOrderIdAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IEnumerable<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">></span></span> orderIds<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">CancellationToken</span> cancellationToken<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<blockquote>\\n<p>See this <a href=\\\"https://fiyazhasan.me/graphql-with-net-core-part-xi-dataloader/\\\">blog series</a> for an in depth example using Entity Framework.</p>\\n</blockquote>\\n<h2 id=\\\"exceptions\\\"><a href=\\\"#exceptions\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Exceptions</h2>\\n<p>Exceptions within data loaders' fetch delegates are passed back to the execution strategy for all associated fields.\\nIf you have a need to capture exceptions raised by the fetch delegate, create a <code class=\\\"language-text\\\">new SimpleDataLoader&lt;T&gt;</code> within\\nyour field resolver (do not use the <code class=\\\"language-text\\\">IDataLoaderContextAccessor</code> for this) and have its fetch delegate await the\\n<code class=\\\"language-text\\\">IDataLoaderResult&lt;T&gt;.GetResultAsync</code> method of the result obtained from the first data loader within a try/catch\\nblock. Return the result of the simple data loader's <code class=\\\"language-text\\\">LoadAsync()</code> function to the field resolver.  The data loader\\nwill still load at the appropriate time, and you can handle exceptions as desired.</p>\",\"fields\":{\"relativePath\":\"docs/guides/dataloader.md\"}},\"site\":{\"siteMetadata\":{\"githubEditUrl\":\"https://github.com/graphql-dotnet/graphql-dotnet/edit/master/docs2/site\"}}},\"pathContext\":{\"relativePath\":\"docs/guides/dataloader.md\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/docs-guides-dataloader.json\n// module id = 334\n// module chunks = 67274500541493"],"sourceRoot":""}